[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "R per l’analisi statistica multivariata",
    "section": "",
    "text": "L’insegnamento di Analisi Statistica Multivariata (15 CFU) è articolato nelle seguenti parti:\nNota: i dettagli legati alle propedeuticità, alla registrazione del voto, al calendario degli esami e al salto d’appello sono spiegate nella pagina principale: Analisi Statistica Multivariata."
  },
  {
    "objectID": "index.html#materiale-didattico",
    "href": "index.html#materiale-didattico",
    "title": "R per l’analisi statistica multivariata",
    "section": "Materiale didattico",
    "text": "Materiale didattico\nIl materiale didattico di ciascuna lezione è scaricabile utilizzando i collegamenti ipertestuali. Si precisa che questa pagina web è soggetta a modifiche, quindi si prega di controllare l’ultima versione aggiornata.\n\nIl software R\n\nR è un software open source ed è possibile scaricarlo al link https://cloud.r-project.org.\nL’uso di Rstudio è facoltativo in questo corso, anche se fortemente consigliato. È possibile scaricarlo al link https://rstudio.com/products/rstudio/.\nLa documentazione del software R è parte integrante del materiale didattico.\n\n\n\nTesti di riferimento\n\nAlbert, J. & M. Rizzo (2012). R by Example. Springer.\n\nRobert, C. & G. Casella (2010). Introducing Monte Carlo Methods with R. Springer\n\n\n\nTesti di consultazione\n\nIl materiale didattico aggiuntivo fornito su questa pagina web.\nAdler, J. (2012). R in a nutshell. O’Reilly.\nGrolemund, G. & Wickham, H. (2016). R for Data Science. O’Reilly.\nVenables, W. N., Smith D. M. & the R Core Team (2021). An Introduction to R.\n\n\n\nMateriale didattico\nLa sigla AR corrisponde al libro di Albert & Rizzo. La sigla RC corrisponde al libro Robert & Casella.\n\n\n\nArgomenti\nMateriale didattico\nMateriale aggiuntivo\nSezioni libro di testo\n\n\n\n\nIntroduzione al corso\nUnità introduttiva\n\n\n\n\n\nINTRODUZIONE AD R\n\n\n\n\nA-B-C: calcolo scientifico ed algebra lineare\nSlides unità A\nCodice R\nAR §1.1, §1.3, §A1 — §A3\n\n\nElementi di programmazione\nSlides unità B\nCodice R\nAR §1.2, §1.6 — §1.8\n\n\nI dataframes\nSlides unità C\nCodice R\nAR §1.4 — §1.5\n\n\nEsercizi\nEsercizi 1\nsoluzione.R\n\n\n\n\nSTATISTICA DESCRITTIVA\n\n\n\n\nAnalisi descrittiva dei dati dde\nSlides unità D\nCodice R\nAR §2.1 — §2.3, §2.7\n\n\nAnalisi descrittiva dei dati emoglobina\nSlides unità E\nCodice R\nAR §2.1 — §2.3, §2.7\n\n\nEsercitazione\nSlides unità F\nCodice R\nAR 7.1, §7.2\n\n\nAnalisi descrittiva dei dati titanic\nSlides unità G\nCodice R\nAR §3.1 — §3.5\n\n\nEsercizi\nEsercizi 2\nsoluzione.R\n\n\n\n\nCALCOLO DELLE PROBABILITÀ\n\n\n\n\nVariabili aleatorie\nSlides unità H\nCodice R\nRC §2.1, §2.2\n\n\nMetodi Monte Carlo\nSlides unità I\nCodice R\nAR §11.1 — §11.5, §13.1, §13.2; RC §3.1, §3.2\n\n\nEsercizi\nEsercizi 3\nsoluzione.R\n\n\n\n\nINFERENZA STATISTICA\n\n\n\n\nMetodi numerici per l’analisi di verosimiglianza\nSlides unità K\nCodice R\nRC §5.1, §5.2\n\n\nProprietà degli stimatori\nSlides unità M\nCodice R\nAR §13.3\n\n\nEsercizi\nEsercizi 4\nsoluzione.R\n\n\n\n\nLEZIONI AGGIUNTIVE\n\n\n\n\nCasinò, roulette e metodi Monte Carlo\nSlides unità J\nCodice R\nAR §11.2\n\n\nMinimi quadrati non lineari\nSlides unità L\nCodice R\n\n\n\n\nESAMI PASSATI\n\n\n\n\nEsame 22 Febbraio 2022\nEsame\nsoluzione.R\n\n\n\nEsame 4 Febbraio 2022\nEsame\nsoluzione.R\n\n\n\nEsame 19 Novembre 2021\nEsame\nsoluzione.R\n\n\n\nEsame 22 Luglio 2021\nEsame\nsoluzione.R\n\n\n\nEsame 30 Giugno 2021\nEsame\nsoluzione.R\n\n\n\nEsame 24 Febbraio 2021\nEsame\nsoluzione.R\n\n\n\nEsame 08 Febbraio 2021\nEsame\nsoluzione.R\n\n\n\n\n\n\nApprofondimenti\n\nArticoli scientifici (in inglese)\n\nHyndman, R. J. and Yanan, F. (1996). Sample quantiles in statistical packages. The American Statistician 50(4), 361–365.\nHitchcock (2003). A history of the Metropolis-Hastings algorithm. The American Statistician 57(4), 254–257.\nOldford (2016). Self-calibrating quantile–quantile plots. The American Statistician 70(1), 74–90."
  },
  {
    "objectID": "index.html#modalità-desame",
    "href": "index.html#modalità-desame",
    "title": "R per l’analisi statistica multivariata",
    "section": "Modalità d’esame",
    "text": "Modalità d’esame\nL’esame si svolge tramite computer e consiste tipicamente in \\(3\\) esercizi da svolgere in R. L’esame si svolgerà sulla Piattaforma Esami Informatizzati.\nLo studente all’esame può consultare sia la documentazione ufficiale di R che il codice utilizzato a lezione, disponibile a questo link.\nPer visionare la prova, è possibile venire a ricevimento. Per ulteriori informazioni relative alla registrazione del voto, al calendario delle verbalizzazioni e al salto d’appello si visiti la pagina: Analisi Statistica Multivariata."
  },
  {
    "objectID": "index.html#propedeuticità",
    "href": "index.html#propedeuticità",
    "title": "R per l’analisi statistica multivariata",
    "section": "Propedeuticità",
    "text": "Propedeuticità\nSi veda la pagina Analisi Statistica Multivariata."
  },
  {
    "objectID": "index.html#ricevimento",
    "href": "index.html#ricevimento",
    "title": "R per l’analisi statistica multivariata",
    "section": "Ricevimento",
    "text": "Ricevimento\nPer fissare un appuntamento, si prega di contattare il docente in anticipo via posta elettronica all’indirizzo tommaso.rigon@unimib.it. Il ricevimento è fissato ogni martedì alle ore 17.30."
  },
  {
    "objectID": "lezioni/un_A.html#unità-a",
    "href": "lezioni/un_A.html#unità-a",
    "title": "R per l’analisi statistica multivariata",
    "section": "Unità A",
    "text": "Unità A\n\nA-B-C: il software R come calcolatrice scientifica\nOperazioni di routine: pulizia del workspace, simboli speciali\nFunzioni matematiche, grafico di una funzione, operazioni logiche\nOperazioni con vettori e matrici\n\n\n\n\n\n\n\nNota\n\n\nEsercizi R associati sono diponibili a questo link"
  },
  {
    "objectID": "lezioni/un_A.html#calcolatrice-scientifica",
    "href": "lezioni/un_A.html#calcolatrice-scientifica",
    "title": "R per l’analisi statistica multivariata",
    "section": "Calcolatrice scientifica",
    "text": "Calcolatrice scientifica\nAnzitutto, R può essere usato come se fosse una calcolatrice scientifica:\n\n2 + 2\n\n[1] 4\n\n4 * (3 + 5) # La somma entro parentesi viene eseguita per prima\n\n[1] 32\n\npi / 4 # Pi greco quarti\n\n[1] 0.7853982\n\n\n\nPer calcolare la potenza \\(a^b\\) si usa:\n\n2^5 # Sintassi alternativa: 2**5\n\n[1] 32\n\n\n\n\nLe quantità \\(\\sqrt{2}\\) e \\(\\sin(\\pi/4)\\) si ottengono invece con i comandi:\n\nsqrt(2)\n\n[1] 1.414214\n\nsin(pi / 4)\n\n[1] 0.7071068\n\n\n\n\n\n\n\n\n\n\nNota\n\n\nTutto ciò che viene scritto dopo un cancelletto (#) è considerato un commento."
  },
  {
    "objectID": "lezioni/un_A.html#assegnazione-di-un-valore",
    "href": "lezioni/un_A.html#assegnazione-di-un-valore",
    "title": "R per l’analisi statistica multivariata",
    "section": "Assegnazione di un valore",
    "text": "Assegnazione di un valore\nÈ possibile salvare un valore assegnandolo ad un oggetto tramite il simbolo <-.\n\n# Assegna il valore 5 all'oggetto x\nx <- sqrt(5) # Sintassi alternativa (sconsigliata): x = sqrt(5)\n\n\nIl valore contenuto in x può essere successivamente richiamato, modificato e salvato in un nuovo oggetto, chiamato ad esempio y.\n\ny <- x + pi # ovvero pi greco + radice quadrata di 5\ny\n\n[1] 5.377661\n\n\n\n\nPer rimuovere un oggetto dalla memoria, si usa il comando rm, ovvero remove.\n\nrm(x) # x non è più presente nel \"workspace\"\n\n\n\n\n\n\n\n\n\nNota\n\n\nR è case sensitive, pertanto l’oggetto x è diverso dall’oggetto X."
  },
  {
    "objectID": "lezioni/un_A.html#pulizia-del-workspace",
    "href": "lezioni/un_A.html#pulizia-del-workspace",
    "title": "R per l’analisi statistica multivariata",
    "section": "Pulizia del workspace",
    "text": "Pulizia del workspace\nÈ buona norma mantenere pulito il workspace, ovvero l’ambiente di lavoro.\nSe un oggetto non è più necessario, è possibile eliminarlo tramite il comando rm.\n\nÈ possibile visualizzare la lista di oggetti salvati in memoria tramite il comando seguente:\n\nls() # Nel workspace è presente l'oggetto y\n\n[1] \"y\"\n\n\n\n\nPertanto, per eliminare tutti gli oggetti salvati, si può usare\n\nrm(list = ls())"
  },
  {
    "objectID": "lezioni/un_A.html#alcune-funzioni-matematiche-i",
    "href": "lezioni/un_A.html#alcune-funzioni-matematiche-i",
    "title": "R per l’analisi statistica multivariata",
    "section": "Alcune funzioni matematiche I",
    "text": "Alcune funzioni matematiche I\nSupponiamo che x sia un numero reale.\nCiò che seguono sono una lista di funzioni disponibili in R:\n\nx <- 1/2 # Esempio di numero reale\n\n\n\nexp(x) # Esponenziale e logaritmo naturale\n\n[1] 1.648721\n\nlog(x)\n\n[1] -0.6931472\n\n\n\n\n\nabs(x) # Valore assoluto\n\n[1] 0.5\n\nsign(x) # Funzione segno\n\n[1] 1"
  },
  {
    "objectID": "lezioni/un_A.html#alcune-funzioni-matematiche-ii",
    "href": "lezioni/un_A.html#alcune-funzioni-matematiche-ii",
    "title": "R per l’analisi statistica multivariata",
    "section": "Alcune funzioni matematiche II",
    "text": "Alcune funzioni matematiche II\n\nsin(x) # Funzioni trigonometriche (seno, coseno, tangente)\n\n[1] 0.4794255\n\ncos(x)\n\n[1] 0.8775826\n\ntan(x)\n\n[1] 0.5463025\n\n\n\n\nasin(x) # Funzioni trigonometriche inverse\n\n[1] 0.5235988\n\nacos(x)\n\n[1] 1.047198\n\natan(x)\n\n[1] 0.4636476\n\n\n\n\n\n\n\n\n\n\nNota\n\n\nLe funzioni di R si possono combinare tra loro, ad esempio log(abs(x))."
  },
  {
    "objectID": "lezioni/un_A.html#ulteriori-funzioni-matematiche-i",
    "href": "lezioni/un_A.html#ulteriori-funzioni-matematiche-i",
    "title": "R per l’analisi statistica multivariata",
    "section": "Ulteriori funzioni matematiche I",
    "text": "Ulteriori funzioni matematiche I\nSupponiamo che x e y siano due numeri reali. Inoltre, siano n e k due numeri naturali.\n\nSi noti l’uso del ; che può essere usato per separare due comandi nella stessa riga.\n\nx <- 1 / 2; y <- 1 / 3 # Numeri reali \nn <- 5; k <- 2 # Numeri naturali\n\n\n\n\nfactorial(n) # n!\n\n[1] 120\n\nchoose(n, k) # Coefficiente binomiale\n\n[1] 10\n\n\n\n\n\nround(x, digits = 2) # Arrotonda x usando 2 cifre decimali\n\n[1] 0.5\n\nfloor(x) # Arrotonda x all'intero più vicino, per difetto\n\n[1] 0\n\nceiling(x) # Arrotonda x all'intero più vicino, per eccesso\n\n[1] 1"
  },
  {
    "objectID": "lezioni/un_A.html#ulteriori-funzioni-matematiche-ii",
    "href": "lezioni/un_A.html#ulteriori-funzioni-matematiche-ii",
    "title": "R per l’analisi statistica multivariata",
    "section": "Ulteriori funzioni matematiche II",
    "text": "Ulteriori funzioni matematiche II\nLa funzione gamma \\(\\Gamma(x) = \\int_0^\\infty s^{x-1} e^{-s} d s\\) si calcola in R come segue:\n\ngamma(x) # Funzione gamma\n\n[1] 1.772454\n\n\n\nLa funzione beta \\(\\mathcal{B}(x,y) = \\int_0^1 s^{x-1}(1-s)^{y-1}ds\\) si calcola in R come segue:\n\nbeta(x, y) # Funzione beta\n\n[1] 4.206546"
  },
  {
    "objectID": "lezioni/un_A.html#grafico-di-una-funzione",
    "href": "lezioni/un_A.html#grafico-di-una-funzione",
    "title": "R per l’analisi statistica multivariata",
    "section": "Grafico di una funzione",
    "text": "Grafico di una funzione\nIn R è possibile disegnare una qualsiasi funzione tramite il comando curve.\nSe ad esempio si considera la funzione \\[f(x) = \\frac{\\sin(x)}{x},\\] allora possiamo disegnare \\(f(x)\\) nell’intervallo \\((0,15)\\) come segue:\n\ncurve(sin(x) / x, from = 0, to = 15)"
  },
  {
    "objectID": "lezioni/un_A.html#la-documentazione-ufficiale",
    "href": "lezioni/un_A.html#la-documentazione-ufficiale",
    "title": "R per l’analisi statistica multivariata",
    "section": "La documentazione ufficiale",
    "text": "La documentazione ufficiale\nLa documentazione di R è la principale fonte di informazioni.\nA cosa serve una funzione? Qual è la definizione dei suoi argomenti? La risposta va sempre cercata nella documentazione ufficiale e non in queste slide.\n\nIl comando ? funzione apre una finestra in cui vengono descritta nel dettaglio una funzione. Esempio:\n\n? log # Documentazione della funzione log\n\n\n\n\n\n\n\n\n\nNota riguardante l’esame\n\n\nDurante la prova d’esame è legittimo (anzi, è caldamente consigliato) consultare la documentazione."
  },
  {
    "objectID": "lezioni/un_A.html#simboli-speciali",
    "href": "lezioni/un_A.html#simboli-speciali",
    "title": "R per l’analisi statistica multivariata",
    "section": "Simboli speciali",
    "text": "Simboli speciali\nNumeri molto grandi, come \\(10^{15}\\), e molto piccoli, come \\(10^{-15}\\), in R vengono rappresentati come segue:\n\n10^15\n\n[1] 1e+15\n\n10^(-15)\n\n[1] 1e-15\n\n\n\nPer questioni di approssimazione numerica, quando un numero è troppo grande R riporta Inf, ovvero infinito. Per esempio:\n\n10^1000 # Numero molto grande, anche se finito\n\n[1] Inf\n\n\n\n\nIl simbolo NaN significa invece Not a Number e si ottiene quando qualche funzione matematica non è stata usata nel modo corretto. Ad esempio:\n\nlog(-1) # Questo comando genera inoltre un avviso\n\nWarning in log(-1): NaNs produced\n\n\n[1] NaN"
  },
  {
    "objectID": "lezioni/un_A.html#errori-di-approssimazione-numerica",
    "href": "lezioni/un_A.html#errori-di-approssimazione-numerica",
    "title": "R per l’analisi statistica multivariata",
    "section": "Errori di approssimazione numerica",
    "text": "Errori di approssimazione numerica\nÈ ben noto che \\(\\sin(\\pi) = 0\\). Tuttavia, in R si ottiene un numero molto vicino a \\(0\\), ma strettamente positivo. Infatti:\n\nsin(pi)\n\n[1] 1.224647e-16\n\n\n\nR è uno strumento di calcolo numerico e pertanto sono sempre presenti errori di approssimazione numerica.\nFortunatamente, nella maggior parte dei casi pratici la differenza tra \\(0\\) e \\(10^{-16}\\) è del tutto irrilevante.\nIn altre situazioni, errori di approssimazione numerica possono portare a conclusioni fuorvianti. Occorre quindi fare attenzione e valutare caso per caso.\n\n\nAd ogni modo, l’approssimazione numerica potrebbe anche migliorare. Ad esempio:\n\ncos(pi)\n\n[1] -1"
  },
  {
    "objectID": "lezioni/un_A.html#operazioni-logiche",
    "href": "lezioni/un_A.html#operazioni-logiche",
    "title": "R per l’analisi statistica multivariata",
    "section": "Operazioni logiche",
    "text": "Operazioni logiche\nIn R è spesso necessario verificare se una o più condizioni sono verificate o meno.\n\nx <- 5\nx < 0 # Il valore di x è minore di 0?\n\n[1] FALSE\n\na <- (x == -3) # Il valore di x è uguale a -3?\na\n\n[1] FALSE\n\n\n\nIl valore di a è un indicatore binario o booleano, ovvero può essere vero (TRUE) oppure falso (FALSE).\n\n\nAltre funzioni logiche disponibili (assumendo che y sia un numero e b un booleano) sono:\n\na <- TRUE; b <- FALSE; x <- 5; y <- 7\nx >= y # x è maggiore o uguale a y? (Si usa \"<=\" per minore uguale)\n\n[1] FALSE\n\nx != y # x è diverso da y?\n\n[1] TRUE\n\na & b # a AND b. I valori booleani a e b sono entrambi veri?\n\n[1] FALSE\n\na | b # a OR b. Almeno uno tra a ed b è vero?\n\n[1] TRUE"
  },
  {
    "objectID": "lezioni/un_A.html#vettori",
    "href": "lezioni/un_A.html#vettori",
    "title": "R per l’analisi statistica multivariata",
    "section": "Vettori",
    "text": "Vettori\nUn vettore in R viene definito tramite la funzione c(), come nel seguente esempio:\n\nx <- c(4, 2, 2, 8, 10) \nx\n\n[1]  4  2  2  8 10\n\n\n\n\n\n\n\n\n\nNota\n\n\nCon il termine generico “vettore” in R non si fa riferimento alla nozione dell’algebra lineare ma semplicemente ad una stringa di valori ordinati.\n\n\n\nIl seguente oggetto è un vettore in R, nonostante l’oggetto x sia composto sia numeri che da lettere\n\nx <- c(\"A\", \"B\", 2, 8, 10)\nx\n\n[1] \"A\"  \"B\"  \"2\"  \"8\"  \"10\""
  },
  {
    "objectID": "lezioni/un_A.html#creazione-di-vettori",
    "href": "lezioni/un_A.html#creazione-di-vettori",
    "title": "R per l’analisi statistica multivariata",
    "section": "Creazione di vettori",
    "text": "Creazione di vettori\nTalvolta è comodo creare dei vettori i cui elementi sono dei numeri consecutivi\n\nx <- 5:10 # Equivalente a: x <- c(5, 6, 7, 8, 9, 10)\nx\n\n[1]  5  6  7  8  9 10\n\n\n\nPer creare una successione di numeri reali si usa il comando seq:\n\nx <- seq(from = 0, to = 1, by = 0.1)\nx\n\n [1] 0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0\n\n\n\n\nPer creare un vettore di valori ripetuti si usa il comando rep:\n\nx <- rep(10, 7) # Vettore in cui il numero 10 è ripetuto 7 volte\nx\n\n[1] 10 10 10 10 10 10 10"
  },
  {
    "objectID": "lezioni/un_A.html#operazioni-sui-vettori-i",
    "href": "lezioni/un_A.html#operazioni-sui-vettori-i",
    "title": "R per l’analisi statistica multivariata",
    "section": "Operazioni sui vettori I",
    "text": "Operazioni sui vettori I\nLa maggior parte delle funzioni matematiche di R sono vettorizzate. In altri termini, le funzioni agiscono su tutti gli elementi di un vettore.\n\nexp(1:6) + (1:6) / 2 + 1 # Esempio 1\n\n[1]   4.218282   9.389056  22.585537  57.598150 151.913159 407.428793\n\n\n\n\nx <- c(10, 10^2, 10^3, 10^4, 10^5, 10^6) # Esempio 2\nlog(x, base = 10)\n\n[1] 1 2 3 4 5 6\n\n\n\n\n\n1:8 > 4 # Esempio 3\n\n[1] FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE\n\n\n\n\nAltre funzioni invece sono utili proprio nel caso in cui l’argomento sia un vettore:\n\nx <- c(2, 3, 1, 3, 10, 5)\nlength(x) # Lunghezza del vettore\n\n[1] 6\n\nsum(x) # Somma degli elementi del vettore\n\n[1] 24\n\ncumsum(x) # Somme cumulate\n\n[1]  2  5  6  9 19 24"
  },
  {
    "objectID": "lezioni/un_A.html#operazioni-sui-vettori-ii",
    "href": "lezioni/un_A.html#operazioni-sui-vettori-ii",
    "title": "R per l’analisi statistica multivariata",
    "section": "Operazioni sui vettori II",
    "text": "Operazioni sui vettori II\nUlteriori semplici operazioni in cui l’argomento è un vettore sono elencate nel seguito:\n\nx <- c(2, 3, 1, 3, 10, 5)\nprod(x) # Prodotto degli elementi del vettore\n\n[1] 900\n\ncumprod(x) # Prodotti cumulati\n\n[1]   2   6   6  18 180 900\n\nsort(x, decreasing = FALSE) # Vettore ordinato in ordine crescente\n\n[1]  1  2  3  3  5 10\n\nmin(x) # Valore minimo\n\n[1] 1\n\nwhich.min(x) # Posizione del valore corrispondente al minimo\n\n[1] 3\n\n\n\nInfine, il funzionamento delle seguenti funzioni dovrebbero essere intuibile da quanto visto finora:\n\nmax(x) # Valore massimo\n\n[1] 10\n\nwhich.max(x) # Posizione del valore corrispondente al massimo\n\n[1] 5\n\nrange(x) # Equivalente a: c(min(x), max(x))\n\n[1]  1 10"
  },
  {
    "objectID": "lezioni/un_A.html#operazioni-sui-vettori-iii",
    "href": "lezioni/un_A.html#operazioni-sui-vettori-iii",
    "title": "R per l’analisi statistica multivariata",
    "section": "Operazioni sui vettori III",
    "text": "Operazioni sui vettori III\nÈ possibile selezionare gli elementi di un vettore usando le parentesi quadrate, come nei seguenti esempi:\n\n# Concatenazione di vettori\nx <- c(rep(pi, 2), sqrt(2), c(10, 7))\nx[3] # Estrae il terzo elemento dal vettore x, ovvero sqrt(2)\n\n[1] 1.414214\n\nx[c(1, 3, 5)] # Estrae il primo, il terzo ed il quinto elemento\n\n[1] 3.141593 1.414214 7.000000\n\nx[-c(1, 3, 5)] # Elimina il primo, il terzo ed il quinto elemento\n\n[1]  3.141593 10.000000\n\nx[x > 3.5] # Estrae gli elementi maggiori di 3.5\n\n[1] 10  7\n\n\n\nL’ultimo comando suggerisce che gli elementi di un vettore possono essere selezionati tramite una condizione relativa al vettore stesso."
  },
  {
    "objectID": "lezioni/un_A.html#operazione-sui-vettori-avvertenze",
    "href": "lezioni/un_A.html#operazione-sui-vettori-avvertenze",
    "title": "R per l’analisi statistica multivariata",
    "section": "Operazione sui vettori: avvertenze",
    "text": "Operazione sui vettori: avvertenze\nCosa succede quando vengono sommati due vettori di dimensioni diverse?\n\n\n\n\n\n\nWarning\n\n\nLa maggior parte dei linguaggi di programmazione restituisce un errore. R invece esegue ugualmente l’operazione “allungando” il vettore più corto.\n\n\n\n\nIn questo primo esempio, quantomeno R restituisce un warning.\n\n# Concatenazione di vettori\nx <- 1:5\ny <- 1:6\nx + y # Equivalente a: c(x, x[1]) + y\n\nWarning in x + y: longer object length is not a multiple of shorter object\nlength\n\n\n[1]  2  4  6  8 10  7\n\n\n\n\nIn questo secondo esempio, invece, R non restituisce alcun avviso, rendendo la cosa particolarmente pericolosa\n\nx <- 1:3\ny <- 1:6\nx + y # Equivalente a: c(x, x) + y\n\n[1] 2 4 6 5 7 9"
  },
  {
    "objectID": "lezioni/un_A.html#matrici",
    "href": "lezioni/un_A.html#matrici",
    "title": "R per l’analisi statistica multivariata",
    "section": "Matrici",
    "text": "Matrici\nUna matrice \\({\\bf A}\\) è una collezione di elementi \\((a)_{ij}\\) per \\(i=1,\\dots,n\\) e \\(j=1,\\dots,m\\).\n\nPer esempio, la matrice quadrata di dimensione \\(2 \\times 2\\)\n\\[{\\bf A} = \\begin{pmatrix}\n5 & 2\\\\\n1 & 4 \\\\\n\\end{pmatrix},\\] si può definire in R tramite il comando matrix come segue:\n\nA <- matrix(c(5, 1, 2, 4), nrow = 2, ncol = 2)\nA\n\n     [,1] [,2]\n[1,]    5    2\n[2,]    1    4\n\n\n\n\nÈ inoltre possibile elencare gli elementi riga per riga\n\n# Definizione equivalente\nA <- matrix(c(5, 2, 1, 4), nrow = 2, ncol = 2, byrow = TRUE)"
  },
  {
    "objectID": "lezioni/un_A.html#vettori-riga-e-vettori-colonna",
    "href": "lezioni/un_A.html#vettori-riga-e-vettori-colonna",
    "title": "R per l’analisi statistica multivariata",
    "section": "Vettori riga e vettori colonna",
    "text": "Vettori riga e vettori colonna\nUna matrice con una sola colonna è un vettore colonna:\n\nx_col <- matrix(c(1, 10, 3, 5), ncol = 1)\nx_col\n\n     [,1]\n[1,]    1\n[2,]   10\n[3,]    3\n[4,]    5\n\n\n\nUna matrice con una sola colonna è un vettore riga:\n\nx_row <- matrix(c(1, 10, 3, 5), nrow = 1)\nx_row\n\n     [,1] [,2] [,3] [,4]\n[1,]    1   10    3    5"
  },
  {
    "objectID": "lezioni/un_A.html#vettori-riga-e-vettori-di-r",
    "href": "lezioni/un_A.html#vettori-riga-e-vettori-di-r",
    "title": "R per l’analisi statistica multivariata",
    "section": "Vettori riga e vettori di R",
    "text": "Vettori riga e vettori di R\nNella maggior parte dei casi, il {vettore riga x_row è intercambiabile col vettore x.\n\nx_row <- matrix(c(1, 10, 3, 5), nrow = 1)\nx <- c(1, 10, 3, 5) # Simile, ma non identico, a x_row\n\nAd esempio, le funzioni sum(x_row) e sum(x) forniscono lo stesso risultato.\n\nCi sono tuttavia alcune lievi distinzioni. Ad esempio:\n\ndim(x_row)\n\n[1] 1 4\n\ndim(x)\n\nNULL\n\n\nIl simbolo NULL significa non definito, perché non esiste la nozione di dimensione per un generico vettore R."
  },
  {
    "objectID": "lezioni/un_A.html#operazioni-sulle-matrici-i",
    "href": "lezioni/un_A.html#operazioni-sulle-matrici-i",
    "title": "R per l’analisi statistica multivariata",
    "section": "Operazioni sulle matrici I",
    "text": "Operazioni sulle matrici I\nÈ possibile selezionare gli elementi di una matrice in maniera analoga a quanto fatto con i vettori.\n\nA[1, 2] # Estrazione di elemento in posizione (1,2)\n\n[1] 2\n\nA[, 2] # Estrazione seconda colonna\n\n[1] 2 4\n\nA[1, ] # Estrazione prima riga\n\n[1] 5 2\n\n\n\nAlcuni comandi di base per manipolare le matrici sono i seguenti\n\ndim(A) # Restituisce la dimensione della matrice\n\n[1] 2 2\n\na <- c(A) # Converte la matrice in un vettore\na\n\n[1] 5 1 2 4\n\n\n\n\n\ndiag(A) # Restituisce la diagonale della matrice\n\n[1] 5 4\n\nt(A) # Calcola la matrice trasposta A'\n\n     [,1] [,2]\n[1,]    5    1\n[2,]    2    4\n\nsum(A) # Somma di tutti gli elementi di A\n\n[1] 12"
  },
  {
    "objectID": "lezioni/un_A.html#operazioni-sulle-matrici-ii",
    "href": "lezioni/un_A.html#operazioni-sulle-matrici-ii",
    "title": "R per l’analisi statistica multivariata",
    "section": "Operazioni sulle matrici II",
    "text": "Operazioni sulle matrici II\nCome per i vettori, le operazioni elementari (somma, prodotto, log, exp, etc.) vengono eseguite elemento per elemento.\n\nexp(A)\n\n           [,1]      [,2]\n[1,] 148.413159  7.389056\n[2,]   2.718282 54.598150\n\n\n\nSiano \\({\\bf A}\\) e \\({\\bf B}\\) due matrici aventi lo stesso numero di colonne e definiamo\n\\[\n{\\bf C} = \\begin{pmatrix}{\\bf A} \\\\ {\\bf B} \\end{pmatrix}.\n\\]\n\nB <- A # Creo una matrice B identica ad A, per semplicità\nC <- rbind(A, B)\nC\n\n     [,1] [,2]\n[1,]    5    2\n[2,]    1    4\n[3,]    5    2\n[4,]    1    4\n\n\n\n\nIn maniera analoga, siano \\({\\bf A}\\) e \\({\\bf B}\\) due matrici aventi lo stesso numero di righe e definiamo \\({\\bf C} = \\begin{pmatrix}{\\bf A} & {\\bf B} \\end{pmatrix}\\).\n\nC <- cbind(A, B)\nC\n\n     [,1] [,2] [,3] [,4]\n[1,]    5    2    5    2\n[2,]    1    4    1    4"
  },
  {
    "objectID": "lezioni/un_A.html#operazioni-sulle-matrici-iii",
    "href": "lezioni/un_A.html#operazioni-sulle-matrici-iii",
    "title": "R per l’analisi statistica multivariata",
    "section": "Operazioni sulle matrici III",
    "text": "Operazioni sulle matrici III\nSiano \\({\\bf x}\\) e \\({\\bf y}\\) due vettori colonna in \\(\\mathbb{R}^p\\). Allora, il loro è pari a\n\\[\n{\\bf x}^\\intercal {\\bf y} = \\sum_{i=1}^p x_i y_i.\n\\]\n\nIn R possiamo usare il comando crossprod\n\nx <- matrix(c(-4, 2, 6, 10, 22), ncol = 1)\ny <- matrix(c(3, 2, 2, 7, 9), ncol = 1)\ncrossprod(x, y) # Equivalente a: sum(x * y)\n\n     [,1]\n[1,]  272\n\n\nIl comando crossprod funziona correttamente anche con “vettori” R.\n\n\nIl comando può essere usato anche per calcolare il seguente prodotto tra matrici \\[\n{\\bf A}^\\intercal {\\bf B},\n\\] dove \\({\\bf A}\\) e \\({\\bf B}\\) sono due matrici di dimensioni compatibili."
  },
  {
    "objectID": "lezioni/un_A.html#operazioni-sulle-matrici-iv",
    "href": "lezioni/un_A.html#operazioni-sulle-matrici-iv",
    "title": "R per l’analisi statistica multivariata",
    "section": "Operazioni sulle matrici IV",
    "text": "Operazioni sulle matrici IV\nIn algebra lineare il prodotto tra matrici compatibili \\({\\bf A} {\\bf B}\\) è chiamato prodotto righe per colonne. In R si usa il comando seguente\n\nA <- rbind(c(1, 2, 3), c(4, 9, 2), c(2, 2, 2))\nB <- rbind(c(5, 2, 5), c(3, 3, 7), c(-2, -8, 10))\n\nA %*% B # Prodotto righe per colonne AB\n\n     [,1] [,2] [,3]\n[1,]    5  -16   49\n[2,]   43   19  103\n[3,]   12   -6   44\n\n\n\nNota. Il comando A * B indica il prodotto elemento per elemento e non il prodotto righe per colonne.\n\n\nSe le matrici non sono compatibili R produce un errore (provateci per esercizio!)"
  },
  {
    "objectID": "lezioni/un_A.html#operazioni-sulle-matrici-v",
    "href": "lezioni/un_A.html#operazioni-sulle-matrici-v",
    "title": "R per l’analisi statistica multivariata",
    "section": "Operazioni sulle matrici V",
    "text": "Operazioni sulle matrici V\nSia \\({\\bf A}\\) una matrice quadrata \\(n \\times n\\) a valori reali. La sua matrice inversa \\({\\bf A}^{-1}\\), quando esiste, è l’unica matrice tale per cui\n\\[\n{\\bf A} {\\bf A}^{-1} = {\\bf A}^{-1} {\\bf A} =  I_n.\n\\]\nPer ottenere \\({\\bf A}^{-1}\\) si usa il comando solve.\n\nA <- rbind(c(1, 2, 3), c(4, 9, 2), c(2, 2, 2))\nA1 <- solve(A) # Matrice inversa di A\nA1\n\n           [,1]        [,2]        [,3]\n[1,] -0.5833333 -0.08333333  0.95833333\n[2,]  0.1666667  0.16666667 -0.41666667\n[3,]  0.4166667 -0.08333333 -0.04166667\n\n\n\n\nround(A %*% A1, digits = 5) # Operazione di controllo\n\n     [,1] [,2] [,3]\n[1,]    1    0    0\n[2,]    0    1    0\n[3,]    0    0    1\n\n\n\n\n\ndet(A) # Calcola il determinante della matrice A\n\n[1] -24"
  },
  {
    "objectID": "lezioni/un_A.html#operazioni-sulle-matrici-vi",
    "href": "lezioni/un_A.html#operazioni-sulle-matrici-vi",
    "title": "R per l’analisi statistica multivariata",
    "section": "Operazioni sulle matrici VI",
    "text": "Operazioni sulle matrici VI\nNel caso una matrice non sia invertibile, il determinante è pari a \\(0\\). Il comando solve in quel caso produce un errore.\n\n# Esempio di matrice NON invertibile\nA <- rbind(c(1, 2, 3), c(2, 4, 6), c(2, 2, 2))\ndet(A) # Deteminante pari a 0, solve(A) produce un errore\n\n[1] 0\n\n\n\nCi sono numerose funzioni per la scomposizione di matrici, il cui output è a volte una lista.\n\nA <- matrix(c(4, 1, 1, 8), ncol = 2)\nchol(A) # Scomposizione di Cholesky\n\n     [,1]     [,2]\n[1,]    2 0.500000\n[2,]    0 2.783882\n\nqr(A) # Scomposizione QR\n\n$qr\n           [,1]      [,2]\n[1,] -4.1231056 -2.910428\n[2,]  0.2425356  7.518604\n\n$rank\n[1] 2\n\n$qraux\n[1] 1.970143 7.518604\n\n$pivot\n[1] 1 2\n\nattr(,\"class\")\n[1] \"qr\"\n\neigen(A) # Scomposizione spettrale\n\neigen() decomposition\n$values\n[1] 8.236068 3.763932\n\n$vectors\n          [,1]       [,2]\n[1,] 0.2297529 -0.9732490\n[2,] 0.9732490  0.2297529"
  },
  {
    "objectID": "lezioni/un_A.html#liste",
    "href": "lezioni/un_A.html#liste",
    "title": "R per l’analisi statistica multivariata",
    "section": "Liste",
    "text": "Liste\nUna lista è una collezione di oggetti (numeri, vettori, matrici, etc).\nPer salvare o per estrarre un oggetto da una lista si usa il simbolo del dollaro $.\n\n# Creazione di una lista\nnew_list <- list(\n  A = matrix(c(4, 1, 1, 8), ncol = 2),\n  x = c(1, 2, 6, 6, 9)\n)\n\nnew_list\n\n$A\n     [,1] [,2]\n[1,]    4    1\n[2,]    1    8\n\n$x\n[1] 1 2 6 6 9"
  },
  {
    "objectID": "lezioni/un_A.html#esempio-la-scomposizione-spettrale",
    "href": "lezioni/un_A.html#esempio-la-scomposizione-spettrale",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esempio: la scomposizione spettrale",
    "text": "Esempio: la scomposizione spettrale\nGli autovalori ed autovettori di una matrice \\(\\textbf{A}\\) si ottengono tramite il comando eigen.\nIl risultato è una lista, contenente gli autovettori (vectors) e autovalori (values).\n\nSpec_A <- eigen(A) # Scomposizione spettrale della matrice A\nSpec_A\n\neigen() decomposition\n$values\n[1] 8.236068 3.763932\n\n$vectors\n          [,1]       [,2]\n[1,] 0.2297529 -0.9732490\n[2,] 0.9732490  0.2297529\n\n\n\n\nSpec_A$values # Estrazione degli autovalori\n\n[1] 8.236068 3.763932"
  },
  {
    "objectID": "lezioni/un_B.html#unità-b",
    "href": "lezioni/un_B.html#unità-b",
    "title": "R per l’analisi statistica multivariata",
    "section": "Unità B",
    "text": "Unità B\n\nDefinizione di una nuova funzione\nIstruzioni di controllo: if, else\nCicli for, cicli while\nCenni alle funzioni *apply\nI pacchetti R\n\n\n\n\n\n\n\nNota\n\n\nEsercizi R associati disponibili a questo link"
  },
  {
    "objectID": "lezioni/un_B.html#funzioni-i",
    "href": "lezioni/un_B.html#funzioni-i",
    "title": "R per l’analisi statistica multivariata",
    "section": "Funzioni I",
    "text": "Funzioni I\nOltre ad essere un software statistico, R è un linguaggio di programmazione.\nLa maggior parte degli oggetti R è una funzione. Infatti:\n\nclass(sum) # Identifica la tipologia di oggetto\n\n[1] \"function\"\n\n\n\n\nclass(log) # Secondo esempio\n\n[1] \"function\"\n\n\n\n\nÈ possibile quindi definire nuove funzioni, in aggiunta a quelle già esistenti.\nUna volta create, le funzioni possono essere usate proprio come tutte le altre."
  },
  {
    "objectID": "lezioni/un_B.html#funzioni-ii",
    "href": "lezioni/un_B.html#funzioni-ii",
    "title": "R per l’analisi statistica multivariata",
    "section": "Funzioni II",
    "text": "Funzioni II\nPer creare una nuova funzione, si utilizza comando function.\nLa nuova funzione cube calcola il cubo del numero ricevuto come input:\n\ncube <- function(x) {\n  out <- x^3\n  out\n}\n\n\nL’ultimo oggetto (in questo caso chiamato out) viene restituito come risultato:\n\ncube(4) # Calcola il cubo del valore 4\n\n[1] 64\n\n\n\n\nPossiamo alternativamente utilizzare anche il comando return per restituire il risultato:\n\ncube <- function(x) {\n  out <- x^3\n  return(out) # Esplicita che il valore da dover restituire è out\n}\ncube(8) # Calcola il cubo del valore 8\n\n[1] 512"
  },
  {
    "objectID": "lezioni/un_B.html#funzioni-iii",
    "href": "lezioni/un_B.html#funzioni-iii",
    "title": "R per l’analisi statistica multivariata",
    "section": "Funzioni III",
    "text": "Funzioni III\nÈ possibile definire nuove funzioni con molteplici argomenti, scegliendo anche i loro eventuali valori predefiniti\n\npower <- function(x, p = 2) {\n  out <- x^p\n  out\n}\n\n\nIl valore predefinito per l’argomento p è il quadrato (p = 2), infatti:\n\npower(x = 4) # Calcola il quadrato del valore 4\n\n[1] 16\n\n\n\n\n\npower(4) # Sintassi alternativa: non è necessario specificare i nomi degli argomenti\n\n[1] 16\n\n\n\n\nTuttavia, possiamo selezionare una potenza diversa nel modo seguente:\n\npower(x = 4, p = 3) # Calcola il cubo del valore 4\n\n[1] 64\n\npower(4, 3) # Sintassi alternativa: non è necessario specificare i nomi degli argomenti\n\n[1] 64"
  },
  {
    "objectID": "lezioni/un_B.html#istruzioni-di-controllo-i",
    "href": "lezioni/un_B.html#istruzioni-di-controllo-i",
    "title": "R per l’analisi statistica multivariata",
    "section": "Istruzioni di controllo I",
    "text": "Istruzioni di controllo I\nL’istruzione di controllo if consente di svolgere una determinata operazione solamente se una certa condizione è verificata (TRUE oppure FALSE).\nL’istruzione di controllo (facoltativa) else consente di svolgere un’operazione alternativa se la precedente condizione non è verificata.\n\nAd esempio, il seguente codice mostra a schermo (funzione print) una frase diversa a seconda che la condizione sia vera o falsa:\n\ncondizione <- pi^2 < 10 # Valore booleano (in questo caso la condizione è TRUE)\n\nif(condizione) {\n  print(\"La condizione è vera\")\n  # Alcuni comandi da eseguire\n  # ...\n} else {\n  print(\"La condizione è falsa\")\n  # Altri comandi da eseguire\n  # ...\n}\n\n[1] \"La condizione è vera\""
  },
  {
    "objectID": "lezioni/un_B.html#istruzioni-di-controllo-ii",
    "href": "lezioni/un_B.html#istruzioni-di-controllo-ii",
    "title": "R per l’analisi statistica multivariata",
    "section": "Istruzioni di controllo II",
    "text": "Istruzioni di controllo II\nLa seguente funzione square_root è un esempio più concreto relativo ad if ed else.\nSe il numero fornito come input è negativo, viene restituito un NaN:\n\nsquare_root <- function(x) {\n  if (x < 0) {\n    # Messaggio di avvertimento; in realtà sarebbe più appropriato usare il comando \"warning\"\n    print(\"Il valore di x deve essere positivo\") \n    out <- NaN # Restituisco Not A Number\n  } else {\n    out <- sqrt(x)\n  }\n  out\n}\n\nsquare_root(-2) # La condizione x < 0 è verificata\n\n[1] \"Il valore di x deve essere positivo\"\n\n\n[1] NaN\n\nsquare_root(36) # La condizione x < 0 NON è verificata\n\n[1] 6"
  },
  {
    "objectID": "lezioni/un_B.html#cicli-while-e-for-i",
    "href": "lezioni/un_B.html#cicli-while-e-for-i",
    "title": "R per l’analisi statistica multivariata",
    "section": "Cicli while e for I",
    "text": "Cicli while e for I\nI cicli for ed i cicli while ripetono l’operazione contenuta tra le parentesi graffe { } fintanto che una determinata condizione non si è verificata.\n\nCominciamo con un semplice esempio relativo alla funzione while:\n\ni <- 5 # Partiamo con i = 5\n\nwhile (i <= 25) { # Ripete l'operazione fintanto che i non è minore o uguale di 25\n  print(i) # Mostra a schermo il valore di i\n  i <- i + 5 # Incrementa il valore di i\n\n  # In contesti reali, qui ovviamente ci sono altre operazioni da eseguire\n  # ...\n}\n\n[1] 5\n[1] 10\n[1] 15\n[1] 20\n[1] 25"
  },
  {
    "objectID": "lezioni/un_B.html#cicli-while-e-for-ii",
    "href": "lezioni/un_B.html#cicli-while-e-for-ii",
    "title": "R per l’analisi statistica multivariata",
    "section": "Cicli while e for II",
    "text": "Cicli while e for II\n\n\n\n\n\n\nWarning\n\n\nAttenzione a non creare dei loop senza fine!\n\n\n\n\nIl codice seguente richiede l’interruzione forzata della sessione di R oppure, nella peggiore delle ipotesi, il riavvio del computer:\n\n# NON ESEGUIRE IL SEGUENTE CODICE!\n#\n# La condizione i <= 25 è sempre vera perché i non viene aggiornato\ni <- 5\nwhile (i <= 25) {\n  print(i)\n\n  # Altre operazioni da eseguire\n  # ...\n}"
  },
  {
    "objectID": "lezioni/un_B.html#cicli-while-e-for-ii-1",
    "href": "lezioni/un_B.html#cicli-while-e-for-ii-1",
    "title": "R per l’analisi statistica multivariata",
    "section": "Cicli while e for II",
    "text": "Cicli while e for II\nIn alternativa ai cicli while, si può usare la sintassi più esplicita dei cicli for.\nIl ciclo esegue il contenuto delle parantesi graffe considerando di volta in volta i valori contenuti ad esempio in un vettore:\n\nvalues <- seq(from = 5, to = 25, by = 5)\nvalues\n\n[1]  5 10 15 20 25\n\nfor (i in values) {\n  print(i + 2) # Mostra a schermo il valore di i + 2\n\n  # Altre operazioni da eseguire\n  # ...\n}\n\n[1] 7\n[1] 12\n[1] 17\n[1] 22\n[1] 27"
  },
  {
    "objectID": "lezioni/un_B.html#esercizio-riassuntivo-i",
    "href": "lezioni/un_B.html#esercizio-riassuntivo-i",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizio riassuntivo I",
    "text": "Esercizio riassuntivo I\nSi calcolino gli elementi di una matrice quadrata \\({\\bf D}\\) di dimensione \\(n \\times n\\), i cui elementi sono pari \\[\nd_{ij} = (x_i - x_j)^2, \\qquad  i,j \\in \\{1,\\dots,n\\},\n\\] dove \\({\\bf x} = (x_1,\\dots,x_n)^\\intercal\\) è un generico vettore in \\(\\mathbb{R}^n\\).\nIn altri termini, si definisca una funzione distances(x) che a partire da un generico vettore x restituisca una matrice D.\n\n\n\n\n\n\n\nTraccia dello svolgimento\n\n\nSi crei innanzitutto una matrice D i cui elementi sono tutti pari a 0, usando il comando matrix.\nQuindi, si usino due cicli for “annidati”, ovvero uno all’interno dell’altro, per calcolare ciascuno dei valori D[i, j]."
  },
  {
    "objectID": "lezioni/un_B.html#soluzione-esercizio-riassuntivo-i",
    "href": "lezioni/un_B.html#soluzione-esercizio-riassuntivo-i",
    "title": "R per l’analisi statistica multivariata",
    "section": "Soluzione esercizio riassuntivo I",
    "text": "Soluzione esercizio riassuntivo I\n\ndistances <- function(x) {\n  n <- length(x) # Ottengo la lunghezza del vettore x\n  D <- matrix(0, nrow = n, ncol = n) # Creazione matrice vuota\n\n  for (i in 1:n) {\n    for (j in 1:n) {\n      D[i, j] <- (x[i] - x[j])^2\n    }\n  }\n  D # Valore da restituire\n}\n\nx <- c(5, 2, 1, 24) # Esempio per verificare che sia corretto\ndistances(x)\n\n     [,1] [,2] [,3] [,4]\n[1,]    0    9   16  361\n[2,]    9    0    1  484\n[3,]   16    1    0  529\n[4,]  361  484  529    0\n\n\n\n\n\n\n\n\nNota\n\n\nEsistono molti modi diversi (ma corretti) di implementare questa funzione. Per inciso, questa soluzione non è affatto il modo più efficiente."
  },
  {
    "objectID": "lezioni/un_B.html#esercizio-riassuntivo-ii",
    "href": "lezioni/un_B.html#esercizio-riassuntivo-ii",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizio riassuntivo II",
    "text": "Esercizio riassuntivo II\nFizzbuzz è un semplice esercizio di programmazione spesso usato nei colloqui di lavoro per verificare le conoscenze di programmazione di base.\nIl compito è il seguente: per tutti i numeri da \\(1\\) a \\(100\\) si stampi a schermo:\n\nla parola fizz se il numero è un multiplo di \\(3\\),\nla parola buzz se è multiplo di \\(5\\),\nla parola fizzbuzz se il numero è un multiplo sia di \\(3\\) che di \\(5\\),\nil numero stesso altrimenti.\n\n\n\n\n\n\n\n\nSuggerimento\n\n\nSi usi la funzione print e la funzione resto % di R. Inoltre, per rendere il codice più snello è possibile usare l’istruzione di controllo chiamata else if."
  },
  {
    "objectID": "lezioni/un_B.html#soluzione-esercizio-riassuntivo-ii",
    "href": "lezioni/un_B.html#soluzione-esercizio-riassuntivo-ii",
    "title": "R per l’analisi statistica multivariata",
    "section": "Soluzione esercizio riassuntivo II",
    "text": "Soluzione esercizio riassuntivo II\nLa soluzione riportata fa uso del costrutto else if.\n\nfor (i in 1:100) {\n  condA <- (i %% 3) == 0 # Il numero è un multiplo di 3?\n  condB <- (i %% 5) == 0 # Il numero è un multiplo di 5?\n  \n  if (condA & condB) {\n    print(\"fizzbuzz\")\n  } else if (condA) {\n    print(\"fizz\")\n  } else if (condB) {\n    print(\"buzz\")\n  } else {\n    print(i)\n  }\n}\n\n[1] 1\n[1] 2\n[1] \"fizz\"\n[1] 4\n[1] \"buzz\"\n[1] \"fizz\"\n[1] 7\n[1] 8\n[1] \"fizz\"\n[1] \"buzz\"\n[1] 11\n[1] \"fizz\"\n[1] 13\n[1] 14\n[1] \"fizzbuzz\"\n[1] 16\n[1] 17\n[1] \"fizz\"\n[1] 19\n[1] \"buzz\"\n[1] \"fizz\"\n[1] 22\n[1] 23\n[1] \"fizz\"\n[1] \"buzz\"\n[1] 26\n[1] \"fizz\"\n[1] 28\n[1] 29\n[1] \"fizzbuzz\"\n[1] 31\n[1] 32\n[1] \"fizz\"\n[1] 34\n[1] \"buzz\"\n[1] \"fizz\"\n[1] 37\n[1] 38\n[1] \"fizz\"\n[1] \"buzz\"\n[1] 41\n[1] \"fizz\"\n[1] 43\n[1] 44\n[1] \"fizzbuzz\"\n[1] 46\n[1] 47\n[1] \"fizz\"\n[1] 49\n[1] \"buzz\"\n[1] \"fizz\"\n[1] 52\n[1] 53\n[1] \"fizz\"\n[1] \"buzz\"\n[1] 56\n[1] \"fizz\"\n[1] 58\n[1] 59\n[1] \"fizzbuzz\"\n[1] 61\n[1] 62\n[1] \"fizz\"\n[1] 64\n[1] \"buzz\"\n[1] \"fizz\"\n[1] 67\n[1] 68\n[1] \"fizz\"\n[1] \"buzz\"\n[1] 71\n[1] \"fizz\"\n[1] 73\n[1] 74\n[1] \"fizzbuzz\"\n[1] 76\n[1] 77\n[1] \"fizz\"\n[1] 79\n[1] \"buzz\"\n[1] \"fizz\"\n[1] 82\n[1] 83\n[1] \"fizz\"\n[1] \"buzz\"\n[1] 86\n[1] \"fizz\"\n[1] 88\n[1] 89\n[1] \"fizzbuzz\"\n[1] 91\n[1] 92\n[1] \"fizz\"\n[1] 94\n[1] \"buzz\"\n[1] \"fizz\"\n[1] 97\n[1] 98\n[1] \"fizz\"\n[1] \"buzz\""
  },
  {
    "objectID": "lezioni/un_B.html#la-famiglia-di-funzioni-apply",
    "href": "lezioni/un_B.html#la-famiglia-di-funzioni-apply",
    "title": "R per l’analisi statistica multivariata",
    "section": "La famiglia di funzioni *apply",
    "text": "La famiglia di funzioni *apply\nQuando possibile, sarebbe meglio evitare l’utilizzo dei cicli for, perché questi tendono ad essere lenti in R (a differenza di altri linguaggi, come C++).\nUn’alternativa più elegante, anche se non necessariamente più efficiente, è la famiglia di funzioni *apply, ovvero: apply, tapply, sapply, mapply, lapply.\nLa più semplice, ovvero apply, esegue una determinata funzione per ciascuna riga / colonna di una matrice.\n\n\n\n\n\n\nEsercizio\n\n\nSi consulti la documentazione delle funzioni *apply per avere una prima idea del loro funzionamento."
  },
  {
    "objectID": "lezioni/un_B.html#i-pacchetti-r",
    "href": "lezioni/un_B.html#i-pacchetti-r",
    "title": "R per l’analisi statistica multivariata",
    "section": "I pacchetti R",
    "text": "I pacchetti R\nCome menzionato nella lezione introduttiva, R è organizzato in pacchetti.\nSe vogliamo utilizzare le funzioni di un pacchetto, questo può essere richiamato usando la funzione library, ovvero:\n\nlibrary(MASS) # Carica in memoria il pacchetto MASS\nlibrary(knitr) # Carica in memoria il pacchetto knitr\n\n\nSe un pacchetto non è presente nel computer è necessario installarlo.\nSi può usare il comando seguente oppure usare la finestra “Packages” presente in RStudio.\n\ninstall.packages(\"knitr\") # Installa il pacchetto knitr"
  },
  {
    "objectID": "lezioni/un_C.html#unità-c",
    "href": "lezioni/un_C.html#unità-c",
    "title": "R per l’analisi statistica multivariata",
    "section": "Unità C",
    "text": "Unità C\n\nL’oggetto data.frame\nImportazione di un dataset in memoria\nEsplorazione e manipolazione di un dataset\nTipologia di variabili\nI valori mancanti\n\n\n\n\n\n\n\nNota\n\n\nEsercizi R associati disponibili a questo link"
  },
  {
    "objectID": "lezioni/un_C.html#gli-oggetti-di-tipo-data.frame",
    "href": "lezioni/un_C.html#gli-oggetti-di-tipo-data.frame",
    "title": "R per l’analisi statistica multivariata",
    "section": "Gli oggetti di tipo data.frame",
    "text": "Gli oggetti di tipo data.frame\nUn oggetto R chiamato data.frame corrisponde alla matrice dei dati.\nCiascuna riga rappresenta quindi un’unità statistica, mentre ciascuna colonna rappresenta invece una variabile.\n\nUn data.frame assomiglia ad una matrice (matrix), ma è pensato per l’analisi dei dati.\nAd esempio, un data.frame può contenere anche valori non numerici, come per esempio le variabili qualitative o valori mancanti.\nCome vedremo, il data.frame viene generalmente caricato all’interno di R utilizzando ad esempio la funzione read.table."
  },
  {
    "objectID": "lezioni/un_C.html#importazione-di-un-dataset",
    "href": "lezioni/un_C.html#importazione-di-un-dataset",
    "title": "R per l’analisi statistica multivariata",
    "section": "Importazione di un dataset",
    "text": "Importazione di un dataset\nIl modo più frequente di caricare un dataset in memoria è importarlo da un file esterno.\nSe i dati hanno dimensioni piccole / medie (dimensione file \\(<\\) 3-4 Gb), sono spesso salvati in formato .csv oppure .txt.\nIn contesti reali e più complessi, è possibile importare i dati a partire direttamente da database relazionali come SQL.\n\nÈ sconsigliabile importare i dati in R a partire da un file Excel. Più in generale, ci sono svariate ragioni per evitare Excel se l’obiettivo è condurre una rigorosa analisi dei dati.\n\n\n\n\n\n\n\n\nNota\n\n\nPer poter procedere con i prossimi comandi, è necessario scaricare il file calcio.csv e salvarlo nel proprio computer. Link al file."
  },
  {
    "objectID": "lezioni/un_C.html#i-dati-grezzi-editor-di-testo",
    "href": "lezioni/un_C.html#i-dati-grezzi-editor-di-testo",
    "title": "R per l’analisi statistica multivariata",
    "section": "I dati grezzi (editor di testo)",
    "text": "I dati grezzi (editor di testo)"
  },
  {
    "objectID": "lezioni/un_C.html#la-cartella-di-lavoro",
    "href": "lezioni/un_C.html#la-cartella-di-lavoro",
    "title": "R per l’analisi statistica multivariata",
    "section": "La cartella di lavoro",
    "text": "La cartella di lavoro\nLa sessione di R attiva è aperta in una specifica cartella di lavoro, identificata dal comando getwd.\nAd esempio, la cartella in cui il codice è stato eseguito è la seguente\n\ngetwd() # Identifica la cartella di lavoro (get working directory)\n\n[1] \"/Users/tommaso/Library/Mobile Documents/com~apple~CloudDocs/University/Bicocca/Didattica/Laboratorio Statistica/introR/lezioni\"\n\n\n\nPer aprire il file calcio.csv, bisogna fornire ad R il percorso del file, che dipende da dove questo è stato salvato (sul Desktop, cartella downloads, etc).\n\n# LA VARIABILE PATH VA CAMBIATA A SECONDA DI DOVE SIA SALVATO IL FILE .csv NEL PROPRIO PC\npath <- \"../dataset/calcio.csv\" # Questo è il percorso del file, relativo a getwd()\n\n\n\nIl percorso del file può anche essere un link, come in questo caso:\n\npath <- \"https://tommasorigon.github.io/introR/dataset/calcio.csv\""
  },
  {
    "objectID": "lezioni/un_C.html#importazione-del-dataset",
    "href": "lezioni/un_C.html#importazione-del-dataset",
    "title": "R per l’analisi statistica multivariata",
    "section": "Importazione del dataset",
    "text": "Importazione del dataset\nÈ anche possibile cambiare la cartella di lavoro tramite il comando setwd.\nIn Rstudio, si può usare l’opzione More -> Set as working directory nella finestra Files, selezionando la cartella di interesse.\nUna volta identificato il corretto path del file, per importare il dataset in memoria si usa ad esempio il comando read.table. Pertanto:\n\ncalcio <- read.table(path, header = TRUE, sep = \",\")\n\n\n\n\n\n\n\n\nNota\n\n\n\nL’opzione header = TRUE significa che la prima riga contiene i nomi delle variabili.\nL’opzione sep = \",\" indica che i vari valori di ciascuna variabile sono separati da una virgola.\n\n\n\n\n\n\nInfine, si noti che nel caso in cui il file sia contenuto nella cartella di lavoro, è quindi sufficiente usare:\n\ncalcio <- read.table(\"calcio.csv\", header = TRUE, sep = \",\")"
  },
  {
    "objectID": "lezioni/un_C.html#esplorazione-di-un-data.frame",
    "href": "lezioni/un_C.html#esplorazione-di-un-data.frame",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esplorazione di un data.frame",
    "text": "Esplorazione di un data.frame\nIn primo luogo, siamo interessati a capire quante variabili e quante osservazioni sono contenute nel dataset data.frame:\n\ndim(calcio) # Equivalente a c(nrow(calcio), ncol(calcio))\n\n[1] 1900    7\n\n\n\nPer verificare di non aver commesso errori grossolani nell’importazione del data.frame, possiamo visualizzare le prime \\(6\\) osservazioni con il comando head:\n\nhead(calcio) # Comando equivalente: calcio[1:6, ]\n\n        Date HomeTeam   AwayTeam FTR B365H B365D B365A\n1 2014-08-30   Chievo   Juventus   A  7.00   4.0  1.50\n2 2014-08-30     Roma Fiorentina   H  1.67   3.8  5.00\n3 2014-08-31 Atalanta     Verona   D  2.05   3.4  3.60\n4 2014-08-31   Cesena      Parma   H  3.10   3.2  2.35\n5 2014-08-31    Genoa     Napoli   A  3.90   3.4  1.95\n6 2014-08-31    Milan      Lazio   H  2.00   3.4  3.75\n\n\n\n\nIl comando tail può essere usato per mostrare le ultime \\(6\\) osservazioni:\n\ntail(calcio) # Comando equivalente: calcio[1895:1900, ]\n\n           Date HomeTeam  AwayTeam FTR B365H B365D B365A\n1895 2011-05-22    Inter   Catania   H  1.53  3.75  7.00\n1896 2011-05-22 Juventus    Napoli   D  1.90  3.60  3.80\n1897 2011-05-22    Lecce     Lazio   A  6.00  3.60  1.60\n1898 2011-05-22  Palermo    Chievo   A  1.75  3.50  4.75\n1899 2011-05-22     Roma Sampdoria   H  1.29  5.00 11.00\n1900 2011-05-22  Udinese     Milan   D  3.50  1.53  6.50"
  },
  {
    "objectID": "lezioni/un_C.html#il-dataset-calcio",
    "href": "lezioni/un_C.html#il-dataset-calcio",
    "title": "R per l’analisi statistica multivariata",
    "section": "Il dataset calcio",
    "text": "Il dataset calcio\nIl dataset calcio contiene quindi un totale di \\(7\\) variabili. Ciascuna osservazione è una partita di calcio avvenuta nel campionato di serie A dal 2008 al 2015.\n\n\nLa variabile Date indica la data della partita.\nLe variabili HomeTeam, AwayTeam indicano la squadra che ha giocato in casa ed in trasferta, rispettivamente.\nLa variabile FTR (“Full Time Result”) indica se la partita è stata vinta dalla squadra di casa (H), dalla squadra in trasferta (A), o si è conclusa con un pareggio (D).\nLe variabili B365H, B365D e B365A, indicano le quote della compagnia di scommesse Bet365 Group Ltd relative ai 3 eventi, prima dell’inizio della partita.\n\n\n\nPer accedere e modificare i nomi delle variabili, si utilizza il comando colnames.\n\ncolnames(calcio) # Per accedere ai nomi delle variabili\n\n[1] \"Date\"     \"HomeTeam\" \"AwayTeam\" \"FTR\"      \"B365H\"    \"B365D\"    \"B365A\""
  },
  {
    "objectID": "lezioni/un_C.html#tipologia-di-variabili",
    "href": "lezioni/un_C.html#tipologia-di-variabili",
    "title": "R per l’analisi statistica multivariata",
    "section": "Tipologia di variabili",
    "text": "Tipologia di variabili\nIn un dataset sono presenti diverse tipologie di variabili.\n\nLe variabili quantitative discrete e continue in R sono codificate come oggetti di tipo integer e numeric, rispettivamente.\n\n\nLe variabili qualitative in R sono codificate come oggetti di tipo character oppure di tipo factor; la differenza tra queste tipologie verrà chiarita nelle prossime slides.\nInfine, le date in R si codificano con la tipologia Date.\n\n\n\n\n\n\n\n\nNota\n\n\nR non sempre riconosce correttamente la tipologia di variabili, come evidenziato dal comando str, che fornisce un sommario del data.frame.\n\nstr(calcio)\n\n'data.frame':   1900 obs. of  7 variables:\n $ Date    : chr  \"2014-08-30\" \"2014-08-30\" \"2014-08-31\" \"2014-08-31\" ...\n $ HomeTeam: chr  \"Chievo\" \"Roma\" \"Atalanta\" \"Cesena\" ...\n $ AwayTeam: chr  \"Juventus\" \"Fiorentina\" \"Verona\" \"Parma\" ...\n $ FTR     : chr  \"A\" \"H\" \"D\" \"H\" ...\n $ B365H   : num  7 1.67 2.05 3.1 3.9 2 2.2 2.3 3.1 1.8 ...\n $ B365D   : num  4 3.8 3.4 3.2 3.4 3.4 3.25 3.4 3.3 3.5 ...\n $ B365A   : num  1.5 5 3.6 2.35 1.95 3.75 3.3 3 2.3 4.5 ..."
  },
  {
    "objectID": "lezioni/un_C.html#variabili-quantitative",
    "href": "lezioni/un_C.html#variabili-quantitative",
    "title": "R per l’analisi statistica multivariata",
    "section": "Variabili quantitative",
    "text": "Variabili quantitative\nPer estrarre una variabile da un data.frame si procede come nel caso delle liste, ovvero tramite il simbolo $. Le variabili possono essere salvate con un nome a piacere.\n\nUna variabile numerica è un vettore R a tutti gli effetti, pertanto possiamo applicare le funzioni che abbiamo già incontrato finora\n\nis.numeric(calcio$B365H) # Verifico che si tratta di una variabile di tipo numeric\n\n[1] TRUE\n\nclass(calcio$B365H)\n\n[1] \"numeric\"\n\ncalcio$B365H[1:10] # Primi 10 elementi di un vettore R\n\n [1] 7.00 1.67 2.05 3.10 3.90 2.00 2.20 2.30 3.10 1.80\n\n\n\n\nLe analisi descrittive di una variabile numerica verranno affrontate nelle unità successive, per ora ci limitiamo alla manipolazione del data.frame."
  },
  {
    "objectID": "lezioni/un_C.html#variabili-qualitative-i",
    "href": "lezioni/un_C.html#variabili-qualitative-i",
    "title": "R per l’analisi statistica multivariata",
    "section": "Variabili qualitative I",
    "text": "Variabili qualitative I\nLe variabili di tipo character sono appropriate per le stringhe di testo, ovvero se ciascun campo corrisponde ad un breve testo, come ad esempio un Tweet.\nLe variabili qualitative con valori ripetuti vanno invece codificate come factor.\nDobbiamo quindi convertire le \\(3\\) variabili HomeTeam, AwayTeam e FTR come segue:\n\ncalcio$HomeTeam <- factor(calcio$HomeTeam)\ncalcio$AwayTeam <- factor(calcio$AwayTeam)\ncalcio$FTR <- factor(calcio$FTR)\n\n\nIn alternativa, possiamo fare questa operazione in fase di lettura di dati, tramite l’opzione stringsAsFactors. Quindi:\n\ncalcio <- read.table(path, header = TRUE, sep = \",\", stringsAsFactors = TRUE)"
  },
  {
    "objectID": "lezioni/un_C.html#variabili-qualitative-ii",
    "href": "lezioni/un_C.html#variabili-qualitative-ii",
    "title": "R per l’analisi statistica multivariata",
    "section": "Variabili qualitative II",
    "text": "Variabili qualitative II\nIn primo luogo, verifichiamo che la conversione sia avvenuta correttamente ed esploriamone il contenuto della variabile HomeTeam:\n\nNelle variabili di tipo factor sono pertanto elencate le varie modalità, chiamati levels in R.\n\n\nPer accedere alle modalità si usa il comando levels, che elenca le modalità della variabile considerata in ordine alfabetico:\n\nlevels(calcio$HomeTeam)\n\n [1] \"Atalanta\"   \"Bari\"       \"Bologna\"    \"Brescia\"    \"Cagliari\"  \n [6] \"Catania\"    \"Cesena\"     \"Chievo\"     \"Empoli\"     \"Fiorentina\"\n[11] \"Genoa\"      \"Inter\"      \"Juventus\"   \"Lazio\"      \"Lecce\"     \n[16] \"Livorno\"    \"Milan\"      \"Napoli\"     \"Palermo\"    \"Parma\"     \n[21] \"Reggina\"    \"Roma\"       \"Sampdoria\"  \"Sassuolo\"   \"Siena\"     \n[26] \"Torino\"     \"Udinese\"    \"Verona\""
  },
  {
    "objectID": "lezioni/un_C.html#variabili-qualitative-iii",
    "href": "lezioni/un_C.html#variabili-qualitative-iii",
    "title": "R per l’analisi statistica multivariata",
    "section": "Variabili qualitative III",
    "text": "Variabili qualitative III\nIl comando levels permette di rinominare le modalità, ad esempio:\n\ncalcio$FTR[1:10]\n\n [1] A H D H A H D D D H\nLevels: A D H\n\nlevels(calcio$FTR) <- c(\"Away\", \"Draw\", \"Home\") # Rinomino le modalità\ncalcio$FTR[1:10]\n\n [1] Away Home Draw Home Away Home Draw Draw Draw Home\nLevels: Away Draw Home\n\n\n\nIl comando levels consente inoltre di accorpare le modalità di una variabile qualitativa:\n\ncalcio$Draw <- calcio$FTR # Creo una copia della variabile FTR chiamata Draw\nlevels(calcio$Draw) <- c(\"Not_Draw\", \"Draw\", \"Not_Draw\") # Accorpamento delle modalità\n\ncalcio$Draw[1:10]\n\n [1] Not_Draw Not_Draw Draw     Not_Draw Not_Draw Not_Draw Draw     Draw    \n [9] Draw     Not_Draw\nLevels: Not_Draw Draw"
  },
  {
    "objectID": "lezioni/un_C.html#le-variabili-di-tipo-date",
    "href": "lezioni/un_C.html#le-variabili-di-tipo-date",
    "title": "R per l’analisi statistica multivariata",
    "section": "Le variabili di tipo date",
    "text": "Le variabili di tipo date\nLa variabile Date del dataset calcio rappresenta una data e pertanto va codificata come tale.\n\nIn R la conversione viene eseguita dal comando as.Date, seguita dal formato in cui è espressa la data:\n\ncalcio$Date <- as.Date(calcio$Date, format = \"%Y-%m-%d\")\nclass(calcio$Date)\n\n[1] \"Date\"\n\ncalcio$Date[1:10]\n\n [1] \"2014-08-30\" \"2014-08-30\" \"2014-08-31\" \"2014-08-31\" \"2014-08-31\"\n [6] \"2014-08-31\" \"2014-08-31\" \"2014-08-31\" \"2014-08-31\" \"2014-08-31\"\n\n\n\n\nUna volta convertito in formata Date, è possibile svolgere alcune operazioni aggiuntive. Ad esempio:\n\nmin(calcio$Date) # Prima partita giocata\n\n[1] \"2008-08-30\"\n\nmax(calcio$Date) # Ultima partita giocata\n\n[1] \"2015-05-31\""
  },
  {
    "objectID": "lezioni/un_C.html#manipolazione-di-un-dataset",
    "href": "lezioni/un_C.html#manipolazione-di-un-dataset",
    "title": "R per l’analisi statistica multivariata",
    "section": "Manipolazione di un dataset",
    "text": "Manipolazione di un dataset\nPer selezionare le righe di un dataset si procede come nel caso delle matrici:\n\ncalcio[c(1806, 501, 109), ]\n\n           Date HomeTeam AwayTeam  FTR B365H B365D B365A     Draw\n1806 2011-03-13    Genoa  Palermo Home  1.91  3.25   4.2 Not_Draw\n501  2013-11-23    Milan    Genoa Draw  1.44  4.20   7.5     Draw\n109  2014-11-09  Palermo  Udinese Draw  2.15  3.30   3.4     Draw\n\n\n\nÈ ovviamente possibile (e tipicamente molto più utile) selezionare le osservazioni che soddisfino una determinata condizione.\n\n\nSupponiamo ad esempio di voler identificare le partite terminate con un pareggio:\n\ncalcio_draw <- calcio[calcio$FTR == \"Draw\", ]\nhead(calcio_draw)\n\n         Date   HomeTeam  AwayTeam  FTR B365H B365D B365A Draw\n3  2014-08-31   Atalanta    Verona Draw  2.05  3.40   3.6 Draw\n7  2014-08-31    Palermo Sampdoria Draw  2.20  3.25   3.3 Draw\n8  2014-08-31   Sassuolo  Cagliari Draw  2.30  3.40   3.0 Draw\n9  2014-08-31     Torino     Inter Draw  3.10  3.30   2.3 Draw\n14 2014-09-14 Fiorentina     Genoa Draw  1.57  3.80   6.0 Draw\n21 2014-09-20     Cesena    Empoli Draw  2.80  3.00   2.7 Draw"
  },
  {
    "objectID": "lezioni/un_C.html#i-valori-mancanti",
    "href": "lezioni/un_C.html#i-valori-mancanti",
    "title": "R per l’analisi statistica multivariata",
    "section": "I valori mancanti",
    "text": "I valori mancanti\nSupponiamo di voler identificare le partite in cui la squadra di casa ha una bassa probabilità di vittoria secondo Bet365:\n\ncalcio_home <- calcio[calcio$B365H > 9, ]\ncalcio_home\n\n           Date HomeTeam AwayTeam  FTR B365H B365D B365A     Draw\n162  2015-01-06   Cesena   Napoli Away   9.5  4.75  1.36 Not_Draw\n224  2015-02-15   Cesena Juventus Draw  15.0  6.00  1.22     Draw\nNA         <NA>     <NA>     <NA> <NA>    NA    NA    NA     <NA>\n1520 2010-05-16    Siena    Inter Away  21.0  9.00  1.10 Not_Draw\nNA.1       <NA>     <NA>     <NA> <NA>    NA    NA    NA     <NA>\nNA.2       <NA>     <NA>     <NA> <NA>    NA    NA    NA     <NA>\n\n\n\n\n\n\n\n\nErrore\n\n\nQualcosa è andato storto: ci sono dei simboli (NA) che non avevamo incontrato finora.\n\n\n\nLa ragione per cui il comando produce dei risultati apparentemente strani è dovuto alla presenza di alcuni dati mancanti, codificati come NA (Not Available)."
  },
  {
    "objectID": "lezioni/un_C.html#i-valori-mancanti-1",
    "href": "lezioni/un_C.html#i-valori-mancanti-1",
    "title": "R per l’analisi statistica multivariata",
    "section": "I valori mancanti",
    "text": "I valori mancanti\nIn particolare, ci sono \\(3\\) osservazioni (la \\(1501\\), \\(1846\\) e la \\(1848\\)) i cui valori relativi a Bet365 non sono disponibili.\n\ncalcio[rowSums(is.na(calcio)) > 0, ] # Identifica le righe con valori mancanti\n\n           Date HomeTeam AwayTeam  FTR B365H B365D B365A     Draw\n1501 2010-05-09  Bologna  Catania Draw    NA    NA    NA     Draw\n1846 2011-04-17   Chievo  Bologna Home    NA    NA    NA Not_Draw\n1848 2011-04-17    Genoa  Brescia Home    NA    NA    NA Not_Draw\n\n\n\nLa funzione is.na produce una matrice logica della stessa dimensione di calcio, contenente TRUE se il valore è mancante e FALSE altrimenti.\n\n\nLa funzione rowSums(matrice) produce un vettore i cui valori alla somma degli elementi di ciascuna riga della matrice.\nDi conseguenza, rowSums(is.na(calcio)) indica quanti valori mancanti sono presenti in ciascuna riga."
  },
  {
    "objectID": "lezioni/un_C.html#gestire-i-dati-mancanti",
    "href": "lezioni/un_C.html#gestire-i-dati-mancanti",
    "title": "R per l’analisi statistica multivariata",
    "section": "Gestire i dati mancanti",
    "text": "Gestire i dati mancanti\nLa gestione statistica dei dati mancanti non è tra gli obiettivi di questo corso.\nLa soluzione più facile, sebbene potenzialmente molto pericolosa, consistente semplicemente nel rimuovere le righe incomplete tramite il comando na.omit:\n\ncalcio_no_na <- na.omit(calcio)\ndim(calcio_no_na)\n\n[1] 1897    8\n\n\n\nPer risolvere il problema originario, ovvero identificare le partite in cui la squadra di casa ha bassa probabilità di vittoria, si può usare subset:\n\ncalcio_home <- subset(calcio, subset = B365H > 9) \ncalcio_home\n\n           Date HomeTeam AwayTeam  FTR B365H B365D B365A     Draw\n162  2015-01-06   Cesena   Napoli Away   9.5  4.75  1.36 Not_Draw\n224  2015-02-15   Cesena Juventus Draw  15.0  6.00  1.22     Draw\n1520 2010-05-16    Siena    Inter Away  21.0  9.00  1.10 Not_Draw"
  },
  {
    "objectID": "lezioni/un_C.html#selezione-delle-variabili",
    "href": "lezioni/un_C.html#selezione-delle-variabili",
    "title": "R per l’analisi statistica multivariata",
    "section": "Selezione delle variabili",
    "text": "Selezione delle variabili\nIl comando subset può essere usato sia per selezionare le righe (osservazioni) che per selezionare le colonne (variabili).\n\nNel secondo caso, si può procedere tramite l’opzione select:\n\ncalcio_B365 <- subset(calcio, select = c(B365H, B365D, B365A))\nhead(calcio_B365)\n\n  B365H B365D B365A\n1  7.00   4.0  1.50\n2  1.67   3.8  5.00\n3  2.05   3.4  3.60\n4  3.10   3.2  2.35\n5  3.90   3.4  1.95\n6  2.00   3.4  3.75\n\n\nOvviamente è possibile anche selezionare sia le righe che le colonne."
  },
  {
    "objectID": "lezioni/un_C.html#il-comando-attach",
    "href": "lezioni/un_C.html#il-comando-attach",
    "title": "R per l’analisi statistica multivariata",
    "section": "Il comando attach",
    "text": "Il comando attach\nIn R esiste un comando chiamato attach. Sebbene usato da molti, questo comando è diabolico e sarebbe meglio evitare di utilizzarlo.\n\nIl comando attach(dataframe) consente di utilizzare le variabili di un data.frame come se queste fossero presenti nel workspace.\nQuesta pratica tuttavia rende il codice molto meno leggibile e spesso conduce ad errori di varia natura.\n\n\nNonostante le varie proteste a favore della rimozione di attach da parte di alcuni, questo comando continua a (r)esistere e viene tuttora usato da molti.\nIn questo corso non verranno forniti esempi di utilizzo di attach per evitare di indurre lo studente in tentazione."
  },
  {
    "objectID": "lezioni/un_C.html#sommario",
    "href": "lezioni/un_C.html#sommario",
    "title": "R per l’analisi statistica multivariata",
    "section": "Sommario",
    "text": "Sommario\nA seguito di tutte queste operazioni, il dataset risulta molto modificato rispetto alla sua versione iniziale.\nRi-eseguendo il comando str otteniamo infatti che\n\nstr(calcio)\n\n'data.frame':   1900 obs. of  8 variables:\n $ Date    : Date, format: \"2014-08-30\" \"2014-08-30\" ...\n $ HomeTeam: Factor w/ 28 levels \"Atalanta\",\"Bari\",..: 8 22 1 7 11 17 19 24 26 27 ...\n $ AwayTeam: Factor w/ 28 levels \"Atalanta\",\"Bari\",..: 13 10 28 20 18 14 23 5 12 9 ...\n $ FTR     : Factor w/ 3 levels \"Away\",\"Draw\",..: 1 3 2 3 1 3 2 2 2 3 ...\n $ B365H   : num  7 1.67 2.05 3.1 3.9 2 2.2 2.3 3.1 1.8 ...\n $ B365D   : num  4 3.8 3.4 3.2 3.4 3.4 3.25 3.4 3.3 3.5 ...\n $ B365A   : num  1.5 5 3.6 2.35 1.95 3.75 3.3 3 2.3 4.5 ...\n $ Draw    : Factor w/ 2 levels \"Not_Draw\",\"Draw\": 1 1 2 1 1 1 2 2 2 1 ..."
  },
  {
    "objectID": "lezioni/un_C.html#il-banco-vince-sempre",
    "href": "lezioni/un_C.html#il-banco-vince-sempre",
    "title": "R per l’analisi statistica multivariata",
    "section": "Il banco vince sempre",
    "text": "Il banco vince sempre\nNelle scommesse calcistiche le quote rappresentano l’inverso della probabilità di un evento, per cui \\[\n    (\\text{Probabilità dell'evento}) = \\frac{1}{(\\text{Quota dell'evento})}\n    \\]\n\nLa quota rappresenta inoltre l’ammontare in € che il vincitore riceve a fronte del pagamento dell’importo unitario di \\(1\\)€.\n\n\nAd esempio, scommettendo \\(10\\)€ sulla vittoria della Juventus nella partita contro il Chievo del 30 Agosto 2014, si sarebbero ottenuti \\(15\\)€, dato che la quota era di \\(1.50\\).\n\n\nSe la scommessa fosse equa, le probabilità di vittoria, pareggio e sconfitta dovrebbero sommare ad \\(1\\).\nTuttavia, questo non accade: le probabilità ottenute sommano ad un valore \\(>1\\). Tale discrepanza si chiama allibramento o aggio e garantisce al banco un guadagno."
  },
  {
    "objectID": "lezioni/un_C.html#esercizio-riassuntivo",
    "href": "lezioni/un_C.html#esercizio-riassuntivo",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizio riassuntivo",
    "text": "Esercizio riassuntivo\n\nSi ottenga la variabile aggio, ottenuta come la differenza tra la somma delle “probabilità” dei \\(3\\) eventi (vittoria, pareggio, sconfitta) ed \\(1\\), ovvero il caso equo.\nSi dica qual è l’aggio associato alla partita Udinese-Parma del 1 Settembre 2013.\nSi dica in quali partite è stato applicato il più basso ed il più alto aggio e si identifichino tali valori.\nIn quale partita è stato applicato l’aggio più alto nel campionato di Serie A del 2009/2010?\n\n\n\n\n\n\n\nSuggerimento\n\n\nSi usino i comandi which.min e which.max. Si consulti la documentazione per capirne il funzionamento."
  },
  {
    "objectID": "lezioni/un_C.html#soluzione",
    "href": "lezioni/un_C.html#soluzione",
    "title": "R per l’analisi statistica multivariata",
    "section": "Soluzione",
    "text": "Soluzione\n\n# Calcolo dell'aggio\ncalcio$aggio <- 1 / calcio$B365H + 1 / calcio$B365D + 1 / calcio$B365A - 1\n\n# Aggio associato a Udinese-Parma del 1 Settembre 2013\nsubset(calcio, Date == \"2013-09-01\" & HomeTeam == \"Udinese\")\n\n          Date HomeTeam AwayTeam  FTR B365H B365D B365A     Draw      aggio\n400 2013-09-01  Udinese    Parma Home   2.1  3.25   3.6 Not_Draw 0.06166056\n\n# Minimo e massimo aggio\ncalcio[which.min(calcio$aggio), ]\n\n          Date HomeTeam AwayTeam  FTR B365H B365D B365A     Draw      aggio\n301 2015-04-18 Juventus    Lazio Home  1.95   3.4  4.33 Not_Draw 0.03788504\n\ncalcio[which.max(calcio$aggio), ]\n\n           Date HomeTeam AwayTeam  FTR B365H B365D B365A Draw     aggio\n1839 2011-04-10  Palermo   Cesena Draw   2.1   2.1     6 Draw 0.1190476\n\n# Il campionato di Serie A inizia a fine Agosto e finisce a fine Maggio\ncalcio2009_2010 <- subset(calcio, Date <= \"2009-08-15\" & Date <= \"2010-06-15\")\ncalcio2009_2010[which.max(calcio2009_2010$aggio), ]\n\n           Date HomeTeam AwayTeam  FTR B365H B365D B365A Draw     aggio\n1125 2009-05-24   Chievo  Bologna Draw   3.2  1.57     6 Draw 0.1161093"
  },
  {
    "objectID": "exe/sol_es_1.html",
    "href": "exe/sol_es_1.html",
    "title": "R per l’analisi statistica multivariata",
    "section": "",
    "text": "Esercizio B\n\nB.1\n\nn <- 10\nsum((-1)^(0:n) * choose(n, 0:n))\n\n[1] 0\n\nn <- 100\nsum((-1)^(0:n) * choose(n, 0:n)) # ERRORE NUMERICO!\n\n[1] -9.861059e+14\n\nn <- 1000\nsum((-1)^(0:n) * choose(n, 0:n)) # ERRORE NUMERICO!\n\n[1] -1.739809e+286\n\n\n\n\n\nB.2\nn <- 10 sum((1:n) * choose(n, 1:n)) n * 2^(n - 1)\nn <- 100 sum((1:n) * choose(n, 1:n)) n * 2^(n - 1)\nn <- 1000 sum((1:n) * choose(n, 1:n)) n * 2^(n - 1)\n\n\nB.3\nn <- 10 sum((-1)^(1:n) * (1:n) * choose(n, 1:n))\nn <- 100 sum((-1)^(1:n) * (1:n) * choose(n, 1:n)) # ERRORE NUMERICO!\nn <- 1000 sum((-1)^(1:n) * (1:n) * choose(n, 1:n)) # ERRORE NUMERICO!\n\n\nEsercizio C\nLa soluzione di un’equazione di secondo grado è ovviamente disponibile in forma chiusa.\n\nroots <- function(a, b, c) {\n  Delta <- b^2 - 4 * a * c\n  if (Delta < 0) stop(\"Il delta deve essere non negativo\")\n  (-b + c(-1, 1) * sqrt(Delta)) / (2 * a)\n}\n\n\n\nC.1\nroots(1, 5, 2)\n\n\nC.2\nroots(1, 2, 1)\n\n\nC.3\nroots(1, 1, 1) # Non esistono soluzioni reali\n\n\nEsercizio D ——————————-\nA <- rbind( c(26, 22, 17, 22, 23), c(22, 18, 14, 23, 27), c(17, 14, 14, 20, 24), c(22, 23, 20, 26, 23), c(23, 27, 24, 23, 12) )\n\n\nD.1\ndet(solve(A)) # 0.0006493506 1 / det(A) # Stesso valore\n\n\nD.2\ndet(A %*% A) # 2371600 det(A)^2 # Stesso valore\n\n\nD.3\nsum(diag(A)) # 96\n\n\nD.4\ndet(A) # 1540 prod(eigen(A)$values) # Stesso valore\n\n\nEsercizio E ———————–\n\n\nE.1\ndist_euclid <- function(x, y) { sqrt(crossprod(x - y)) }\n\n\nE.2\nx <- c(1, 4, 2, 2, 10) y <- c(8, 1, 8, 3, 6) dist_euclid(x, y) # 10.53565\n\n\nEsercizio F ————————\n\n\nF.1\nfrobenius_norm <- function(A) { sqrt(sum(A^2)) }\nA <- cbind(1:5, 6:10, 11:15) frobenius_norm(A) # 35.21363\n\n\nEsercizio G ——————————\ndata(mtcars)\n\n\nG.1\ndim(mtcars) # 32 righe, 11 colonne\n\n\nG.2\nmtcars[1:20] # Bisogna aggiungere una virgola mtcars[1:20, ] # Comando corretto\n\n\nG.3\n\n\nmtcars[mtcars\\(cyl = 4, ] # COMANDO ERRATO mtcars[mtcars\\)cyl == 4, ] # COMANDO CORRETTO\n\n\nmtcars[-1:4, ] # COMANDO ERRATO\nmtcars[-(1:4), ] # COMANDO CORRETTO (elimina le prima 4 righe)\n\n\nmtcars[mtcars\\(cyl <= 5] # COMANDO ERRATO mtcars[mtcars\\)cyl <= 5, ] # COMANDO CORRETTO\n\n\nmtcars[mtcars\\(cyl == 4 | 6, ] # COMANDO ERRATO mtcars[mtcars\\)cyl == 4 | mtcars$cyl == 6, ] # COMANDO CORRETTO\n\n\nEsercizio H ——————————-\ndiag2 <- function(A) { n <- nrow(A) diagonal <- numeric(n) for (i in 1:n) { diagonal[i] <- A[i, i] } diagonal }\nA <- rbind( c(26, 22, 17, 22, 23), c(22, 18, 14, 23, 27), c(17, 14, 14, 20, 24), c(22, 23, 20, 26, 23), c(23, 27, 24, 23, 12) )\ndiag(A) diag2(A)\n\n\nEsercizio I ———————————-\n\n\nLa consegna chiedeva di indovinare il risultato senza eseguire il codice.\n\n\nSe eseguito, si ottiene 202."
  },
  {
    "objectID": "exe/es_1.html",
    "href": "exe/es_1.html",
    "title": "R per l’analisi statistica multivariata",
    "section": "",
    "text": "Si scriva in R la funzione f(x) associata a\n\\[\nf(x) = \\frac{|\\sin(\\pi/4 x^2)|}{x}, \\qquad x \\neq 0.\n\\]\n\nQuanto vale \\(f(1)\\)? Quanto vale \\(f(10^8)\\)?\nSi approssimino \\(f(1)\\) ed \\(f(10)\\) alle prime due cifre decimali.\nSi faccia un grafico della funzione \\(f(x)\\) nell’intervallo \\((1,3)\\).\nSi calcoli \\(\\sum_{k=1}^{K} f(k)\\), per \\(K = 500\\).\nDifficile. La funzione integrate di R (si veda la documentazione), permette di calcolare numericamente integrali del tipo \\[\nI = \\int_a^b f(x)\\mathrm{d}x,\n\\] dove \\(a < b\\) sono due valori reali. Si calcoli il valore dell’integrale \\(\\int_1^3 f(x)\\mathrm{d}x\\), dove \\(f(x)\\) è la funzione usata nei punti precedenti."
  },
  {
    "objectID": "exe/es_1.html#esercizio-b",
    "href": "exe/es_1.html#esercizio-b",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizio B",
    "text": "Esercizio B\nSi verifichino numericamente le seguenti identità per \\(n = 10, 100, 1000\\) (ove possibile).\n\n\\[\n\\sum_{k=0}^n(-1)^k\\binom{n}{k} = 0.\n\\]\n\\[\n\\sum_{k=1}^n k \\binom{n}{k} = n 2^{n-1}.\n\\]\n\\[\n\\sum_{k=1}^n(-1)^{k+1}k \\binom{n}{k} = 0.\n\\]"
  },
  {
    "objectID": "exe/es_1.html#esercizio-c",
    "href": "exe/es_1.html#esercizio-c",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizio C",
    "text": "Esercizio C\nSi scriva in R una funzione roots(a, b, c) che riceve come input i coefficienti del polinomio\n\\[\na x^2 + b x + c,\n\\] e restituisce il vettore dei valori di \\(x\\) che lo rendono pari a zero.\n\nSi calcoli roots(1, 5, 2);\nSi calcoli roots(1, 2, 1);\nSi calcoli roots(1, 1, 1) e si commenti il risultato."
  },
  {
    "objectID": "exe/es_1.html#esercizio-d",
    "href": "exe/es_1.html#esercizio-d",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizio D",
    "text": "Esercizio D\nSi definisca in R una matrice simmetrica \\({\\bf A}\\) di dimensione \\(5 \\times 5\\), i cui elementi sono \\[\n{\\bf A} = \\begin{pmatrix}\n26 &  22 &  17 &  22 &  23 \\\\\n22 &  18 &  14 &  23 &  27 \\\\\n17 &  14 &  14 &  20 &  24 \\\\\n22 &  23 &  20 &  26 &  23 \\\\\n23 &  27 &  24 &  23 &  12 \\\\\n\\end{pmatrix}.\n\\]\n\nSi verifichi empiricamente che \\(\\text{det}({\\bf A}^{-1}) = 1 / \\text{det}({\\bf A})\\).\nSi verifichi empiricamente che \\(\\text{det}({\\bf A}^2) = \\text{det}({\\bf A})^2\\).\nSi calcoli la traccia di \\({\\bf A}\\), ovvero \\(\\text{tr}({\\bf A}) = \\sum_{i=1}^n a_{ii}\\), per \\(n = 5\\).\nSe verifichi empiricamente che \\(\\text{det}({\\bf A}) = \\prod_{i=1}^n \\lambda_i\\), dove \\(\\lambda_1,\\dots,\\lambda_n\\) sono gli autovalori di \\({\\bf A}\\)."
  },
  {
    "objectID": "exe/es_1.html#esercizio-e",
    "href": "exe/es_1.html#esercizio-e",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizio E",
    "text": "Esercizio E\nLa distanza euclidea tra due vettori \\({\\bf x}\\) e \\({\\bf y}\\) in \\(\\mathbb{R}^p\\) è definita come \\[d({\\bf x},{\\bf y}) = \\sqrt{\\sum_{j=1}^p(x_j - y_j)^2}.\\]\n\nSi scriva la funzione R dist_euclid(x, y) che calcola la distanza euclidea tra due vettori.\nSe x = c(1, 4, 2, 2, 10) e y = c(8, 1, 8, 3, 6), quanto vale dist_euclid(x, y)?"
  },
  {
    "objectID": "exe/es_1.html#esercizio-f",
    "href": "exe/es_1.html#esercizio-f",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizio F",
    "text": "Esercizio F\nLa norma di Frobenius \\(||{\\bf A}||_F\\) di una matrice \\({\\bf A}\\) a valori reali di dimensione \\(n \\times m\\) è definita come \\[||{\\bf A}||_F = \\sqrt{\\sum_{i=1}^n \\sum_{j=1}^m a_{ij}^2}.\\]\n\nSi scriva la funzione R frobenius_norm(A) che calcola la norma di Frobenius per una matrice A.\nSe A = cbind(1:5,6:10,11:15), quanto vale frobenius_norm(A)?"
  },
  {
    "objectID": "exe/es_1.html#esercizio-g",
    "href": "exe/es_1.html#esercizio-g",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizio G",
    "text": "Esercizio G\nSi consideri il dataset data(mtcars), che è presente in R. Si risponda quindi alle seguendi domande:\n\nQuante righe e quante colonne compongono tale dataset?\nCome mai il comando mtcars[1:20] restituisce un errore? Qual è la differenza dal comando mtcars[1:20, ]?\nCiascuna delle seguenti righe contiene degli errori (bug). Si propongano delle modifiche per sistemarlo\n\n\nmtcars[mtcars$cyl = 4, ] \nmtcars[-1:4, ] \nmtcars[mtcars$cyl <= 5] \nmtcars[mtcars$cyl == 4 | 6, ]"
  },
  {
    "objectID": "exe/es_1.html#esercizio-h",
    "href": "exe/es_1.html#esercizio-h",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizio H",
    "text": "Esercizio H\nSia \\({\\bf A}\\) una matrice di dimensione \\(n \\times n\\). Si implementi una funzione che estrae gli elementi della diagonale \\(a_{ii}\\), per \\(i = 1,\\dots,n\\) della matrice \\({\\bf A}\\). La si confronti quindi con la funzione diag di R."
  },
  {
    "objectID": "exe/es_1.html#esercizio-i",
    "href": "exe/es_1.html#esercizio-i",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizio I",
    "text": "Esercizio I\nChe cosa restituisce la funzione f(10)? Si discuta il risultato senza eseguire il seguente codice\n\nh <- function(x) {\n  x^2 \n}\n\ng <- function(x) {\n  h(x) + 1 \n}\n\nf <- function(x) {\n  g(x)*2 \n}\n\nf(10)"
  },
  {
    "objectID": "exe/es_1.html#esercizi-tratti-dai-libro-di-testo-albert-rizzo-ar",
    "href": "exe/es_1.html#esercizi-tratti-dai-libro-di-testo-albert-rizzo-ar",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizi tratti dai libro di testo Albert & Rizzo (AR)",
    "text": "Esercizi tratti dai libro di testo Albert & Rizzo (AR)\n\nEsercizio 1.2, pag. 39.\nEsercizio 1.3, pag. 39.\nEsercizio 1.11, pag. 41."
  },
  {
    "objectID": "exe/es_1.html#esercizi-tratti-dai-libro-di-testo-robert-casella-rs",
    "href": "exe/es_1.html#esercizi-tratti-dai-libro-di-testo-robert-casella-rs",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizi tratti dai libro di testo Robert & Casella (RS)",
    "text": "Esercizi tratti dai libro di testo Robert & Casella (RS)\n\nEsercizio 1.3, pag. 9.\nEsercizio 1.4, pag. 9.\nEsercizio 1.5, pag. 9.\nEsercizio 1.9, pag. 31.\nEsercizio 1.12, pag. 38."
  },
  {
    "objectID": "exe/es_2.html",
    "href": "exe/es_2.html",
    "title": "R per l’analisi statistica multivariata",
    "section": "",
    "text": "La varianza campionaria dei dati \\({\\bf x} = (x_1,\\dots,x_n)\\) è definita come\n\\[\n\\text{var}({\\bf x}) = \\frac{1}{n}\\sum_{i=1}^n(x_i - \\bar{x})^2,\n\\] dove \\(\\bar{x}\\) è la media campionaria. Si noti che \\(\\text{var}({\\bf x})\\) ammette la rappresentazione alternativa\n\\[\\text{var}({\\bf x}) = \\frac{1}{2 n^2} \\sum_{i=1}^n \\sum_{j = 1}^n (x_i - x_j)^2.\\]\n\n\nSi scriva una funzione var2(x) che calcola la varianza di \\({\\bf x}\\) utilizzando la definizione.\nSi scriva una funzione var3(x) che calcola la varianza di \\({\\bf x}\\) utilizzando la formula basata sulle distanze tra coppie di elementi.\nSi supponga che x = c(1, 4, 2, 2, 10). Si verifichi che le due funzioni var2(x) e var3(x) forniscono lo stesso risultato.\nSi supponga ora che x <- 1:3000. Si notano differenze rispetto al punto precedente?\nSi confrontino le funzioni var2 e var3 con la funzione var implementata in R, utilizzando i dati del punto 3. Come mai i risultati differiscono, anche se di poco? Si consulti la documentazione per rispondere."
  },
  {
    "objectID": "exe/es_2.html#esercizio-b",
    "href": "exe/es_2.html#esercizio-b",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizio B",
    "text": "Esercizio B\nQuesto esercizio ripercorre l’unità I del corso Statistica I, a cui si rimanda per un ripasso sugll’indice di Gini e una descrizione del problema.\nA questo link sono disponibili i dati delle elezioni municipali del 2016 presso il comune di Milano.\n\n\nSi carichino in memoria i dati.\nQuali variabili contiene il dataset elez? Di quale tipologia sono?\nSi ottenga il numero di voti ottenuti da ciascun candidato nei differenti Municipi di Milano.\nSi ottenga il numero di voti ottenuti da ciascun candidato e se ne faccia un grafico. Si ottenga inoltre la percentuale di voti ottenuti da ciascun candidato.\nSi scriva la funzione Gini(x) che calcola l’indice di Gini per una variabile qualitativa. L’indice di Gini è definito come \\[\nG = 1 - \\sum_{j=1}^k f_j^2,\n\\] dove \\(f_1,\\dots,f_k\\) sono le frequenze relative delle \\(k\\) modalità.\nSi scriva una funzione Gini_norm(x)che calcola l’indice di Gini normalizzato, ovvero \\[G_\\text{norm} = \\frac{k}{k-1} G.\\]\nSi valuti la polarizzazione dei voti tra i candidati nelle diverse municipalità utilizzando l’indice di Gini normalizzato. Si organizzino quindi i risultati in una tabella e si dica quale municipalità presenta la polarizzazione maggiore."
  },
  {
    "objectID": "exe/es_2.html#esercizio-c",
    "href": "exe/es_2.html#esercizio-c",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizio C",
    "text": "Esercizio C\nQuesto esercizio riprende i dati considerati nell’unità J del corso Statistica I, a cui si rimanda per una descrizione più approfondita del dataset.\nI dati sono disponibili a questo link.\n\n\nSi carichino i dati in memoria e si salvi il dataset nell’oggetto province.\nQuali variabili contiene il dataset province? Di quale tipologia sono?\nSi rappresenti graficamente la variabile istruzione tramite istogramma. Si calcoli quindi media, mediana e varianza.\nSi rappresenti graficamente la funzione di ripartizione della variabile agricoltura.\nSi rappresenti il diagramma a dispersione delle variabili agricoltura e istruzione. Si può notare una qualche relazione?\nSi ottenga la matrice di varianza e covarianza.\nSi ottenga la matrice di correlazione. Si commenti la relazione esistente tra agricoltura e istruzione."
  },
  {
    "objectID": "exe/es_2.html#esercizio-d",
    "href": "exe/es_2.html#esercizio-d",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizio D",
    "text": "Esercizio D\nNel dataset calcio disponibile a questo link, ciascuna unità statistica rappresenta una partita di calcio della Serie A italiana, relativa ai campionati 2008-2015. Il dataset è composto dalle seguenti variabili:\n\nDate indica la data della partita.\nHomeTeam e AwayTeam indicano, rispettivamente, la squadra che gioca in casa e la squadra ospite per ciascuna partita.\nFTR indica se la squadra che giocava in casa ha vinto (H), pareggiato (D), oppure perso (A).\nLe variabili B365H, B365D, B365A sono le quote per la vittoria, pareggio, sconfitta della squadra di casa.\n\nSupponendo di scommettere sulla vittoria della squadra di casa, puntando un euro su di essa si otterrebbero B365H euro in caso di vittoria.\n\n\nSi carichi il dataset in memoria.\nVerificare le tipologie di variabili presenti nel dataset calcio.\nControllare se esistono dei dati mancanti nel dataset. Se presenti, si escludano le righe contenenti dei valori mancanti dall’analisi. Suggerimento: si usi la funzione na.omit.\nCalcolare i principali indici descrittivi per la variabile B365H. Rappresentarla poi tramite istogramma ed il boxplot. Sono presenti valori anomali? Da cosa è possibile intuirlo?\nEffettuare l’analisi del punto precedenti sulla trasformazione logaritmica di B365H. Sono presenti valori anomali?\nValutare la correlazione presente tra B365H e B365A. Ci si poteva aspettare un risultato simile? Cosa implicherebbe una correlazione positiva?\nRappresentare con un grafico opportuno la relazione tra le trasformate logaritmiche delle variabili B365H e B365A. Si commenti il risultato.\nValutare la quota media B365H per ciascuna categoria della variabile FTR. Come si interpreta questo risultato?\nRappresentare tramite boxplot la variabile B365H per ciascuna categoria della variabile FTR. Si commenti il risultato."
  },
  {
    "objectID": "exe/es_2.html#esercizio-e",
    "href": "exe/es_2.html#esercizio-e",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizio E",
    "text": "Esercizio E\nNel dataset imdb disponibile a questo link, ciascuna unità statistica è un film estratto dal sito http://www.imdb.com/ (Internet Movie Data Base). Per ciascun film, sono a disposizione le seguenti variabili:\n\nmovie_title è il titolo del film.\nduration è la durata del film espressa in minuti.\nlgrossè la trasformazione logaritmica dell’incasso lordo, espresso in dollari.\nlbudgetè la trasformazione logaritmica del budget, espresso in dollari.\nAction, Adventure, Animation, Comedy, Crime, Documentary, Drama, Family, Fantasy, History, Horror, Music, Romance, SciFi, Thriller, War, Western, sono variabili qualitative che indicano se il film appartiene o meno al genere. Ciascun film può appartenere a più generi contemporaneamente.\n\n\n\nSi carichi il dataset in memoria. Si controlli la tipologia delle variabili.\nQuante sono le unità statistiche?\nQual è la durata media dei film del dataset? E l’incasso medio?\nCi sono differenze tra la distribuzione della durata (duration) dei film drammatici (Drama) e quelli non drammatici? Si risponda tramite opportuni indici descrittivi ed analisi grafiche.\nQuali sono i 5 film che presentano, all’interno del dataset, i maggiori incassi? Suggerimento: si usi la funzione order.\nRappresentare con grafici appropriati le distribuzioni marginali e la distribuzione congiunta delle variabili lbudget e lgross. Che tipo di relazione sembra esserci tra le due variabili?\nSi calcoli la correlazione tra lbudget e lgross e si commenti il risultato.\nSi calcoli la correlazione tra duration e lgross e si commenti il risultato. Possiamo quindi concludere che, per guodagnare molto, sia sufficiente produrre un film della durata di 12 ore?"
  },
  {
    "objectID": "exe/es_2.html#esercizi-tratti-dai-libro-di-testo-albert-rizzo-ar",
    "href": "exe/es_2.html#esercizi-tratti-dai-libro-di-testo-albert-rizzo-ar",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizi tratti dai libro di testo Albert & Rizzo (AR)",
    "text": "Esercizi tratti dai libro di testo Albert & Rizzo (AR)\n\nEsercizio 1.14, pag. 41.\nEsercizio 2.1, pag. 75.\nEsercizio 2.2, pag. 75.\nEsercizio 2.3, pag. 75.\nEsercizi 2.4 e 2.5, pag. 75-76.\nEsercizio 2.10, pag. 77.\nEsercizio 2.12, pag. 77.\nEsercizio 3.1, pag. 96.\nEsercizio 3.4, pag. 98."
  },
  {
    "objectID": "exe/es_3.html",
    "href": "exe/es_3.html",
    "title": "R per l’analisi statistica multivariata",
    "section": "",
    "text": "È ragionevole supporre che la durata dei voli diretti Milano - New York si distribuisca come una normale di media \\(\\mu=500\\) minuti e varianza \\(\\sigma^2 = 625\\).\n\nCon quale probabilità un volo impiegherà meno di 9 ore (540 min) per arrivare a destinazione?\nCon quale probabilità un volo impiegherà più di 8 ore e mezza (510 min) per arrivare?\nSi valuti la percentuale di aerei che impiega un tempo compreso tra 470 e 520 minuti."
  },
  {
    "objectID": "exe/es_3.html#esercizio-b",
    "href": "exe/es_3.html#esercizio-b",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizio B",
    "text": "Esercizio B\nLa funzione errore erf(x) ammette la seguente espansione in serie\n\\[\\text{erf}(x) = \\frac{2}{\\sqrt{\\pi}} \\int_0^x e^{-s^2}ds = \\frac{2}{\\sqrt{\\pi}} \\sum_{n=0}^\\infty(-1)^n \\frac{x^{2n +1}}{n!(2n+1)}.\\] Inoltre, si noti che\n\\[\n\\mathbb{P}(X \\le x) = \\Phi(x) = \\frac{1}{2}\\left[1 + \\text{erf}(x/\\sqrt{2}) \\right].\n\\] Dove \\(X \\sim N(0,1)\\) è una distribuzione normale standard.\n\nSi costruiscano le funzioni erf_approx(x,N) e pnorm_approx(x, N) basate su un troncamento al termine \\(N\\)-esimo della serie mostrata qui sopra. In altri termini, si usi l’approssimazione \\[\\text{erf}(x) \\approx \\frac{2}{\\sqrt{\\pi}} \\sum_{n=0}^N(-1)^n \\frac{x^{2n +1}}{n!(2n+1)}.\\]\nSi valutino le funzioni erf_approx(x,N) e pnorm_approx(x, N) nei punti \\(x = 0\\), \\(x = 1\\) e \\(x = 2\\), avendo fissato \\(N = 10\\). Si commentino i risultati.\nSi confrontino i valori del punto precedente con il valore ottenuto tramite la funzione pnorm. Si faccia quindi un ulteriore confronto nel punto \\(x = -3\\) usando \\(N = 10\\). Si commenti.\nSi approssimi la probabilità \\(\\mathbb{P}(X \\le -3)\\) tramite simulazione."
  },
  {
    "objectID": "exe/es_3.html#esercizio-c",
    "href": "exe/es_3.html#esercizio-c",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizio C",
    "text": "Esercizio C\nIn un noto gioco da tavolo, si usano dadi a \\(20\\) facce. Il lancio del dado pertanto corrisponde ad una variabile aleatoria \\(X\\) tale che\n\\[\n\\mathbb{P}(X = k) = \\frac{1}{20}, \\qquad k=1,\\dots,20.\n\\]\n\nPer superare una determinata prova, un giocatore lancia il dado da \\(20\\). Dopo aver aggiunto \\(5\\) al risultato, il giocatore controlla se il totale è maggiore o uguale a \\(17\\). Si calcoli la probabilità di questo evento analiticamente e tramite simulazione.\n\nIn determinati contesti, al giocatore è concesso un vantaggio. Questo significa che può tirare il dado due volte e considerare il risultato più alto. In formule, siano \\(X_1,X_2\\) due variabili aleatorie indipendenti e distribuite come \\(X\\). Si ponga quindi \\(Z = \\max\\{X_1,X_2\\}\\).\n\nSi rappresenti graficamente la distribuzione di probabilità di \\(Z\\).\nSi ottenga tramite simulazione la probabilità \\(\\mathbb{P}(Z + 5 \\ge 17)\\). Si confronti il risultato con la probabilità ottenuta al punto precedente. Al giocatore è effettivamente concesso un vantaggio?"
  },
  {
    "objectID": "exe/es_3.html#esercizio-d-difficile",
    "href": "exe/es_3.html#esercizio-d-difficile",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizio D (difficile)",
    "text": "Esercizio D (difficile)\nUna variabile aleatoria \\(X\\) è distribuita come una variabile di Cauchy (standard) se la sua densità è pari a\n\\[\nf(x) = \\frac{1}{\\pi}\\frac{1}{1 + x^2}, \\qquad x \\in \\mathbb{R}.\n\\] Suggerimento: si usino la funzioni dcauchy, pcauchy, qcauchy e rcauchy.\n\nSi rappresenti graficamente la funzione \\(f(x)\\) nell’intervallo \\((-4,4)\\) e si confronti il grafico con la densità di una normale standard.\nSi calcoli tramite simulazione la probabilità che \\(X\\) sia maggiore di \\(3\\). Si confronti il risultato ottenuto con il valore teorico.\nSiano \\(X_1,\\dots,X_n\\) dei valori iid da una Cauchy standard e si calcoli \\[\n\\frac{1}{n}\\sum_{i=1}^nX_i,\n\\] per vari valori di \\(n = 10^2, 10^3, 10^4, 10^5\\). Si ripeta l’esperimento alcune volte. La media aritmetica dei valori simulati sembra convergere? Si commenti il risultato."
  },
  {
    "objectID": "exe/es_3.html#esercizio-e",
    "href": "exe/es_3.html#esercizio-e",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizio E",
    "text": "Esercizio E\nL’indice di asimmetria di Bowley di una variabile aleatoria è definito come segue\n\\[\nB = \\frac{\\mathcal{Q}(0.75) - 2\\mathcal{Q}(0.5) + \\mathcal{Q}(0.25)}{\\mathcal{Q}(0.75) - \\mathcal{Q}(0.25)}.\n\\]\n\nSi calcoli l’indice di asimmetria di Bowley di una distribuzione gaussiana di media \\(5\\) e varianza \\(25\\).\nSi calcoli l’indice di Bowley per una distribuzione gamma di parametri \\(\\alpha = 2\\) e \\(\\beta = 4\\) e si commenti il risultato.\nSi calcoli l’indice di Bowley per una distribuzione gamma di parametri \\(\\alpha = 200\\) e \\(\\beta = 400\\) e lo si confronti col valore ottenuto al punto precedente. Si commenti il risultato."
  },
  {
    "objectID": "exe/es_3.html#esercizio-f",
    "href": "exe/es_3.html#esercizio-f",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizio F",
    "text": "Esercizio F\nLa distribuzione beta-binomiale di parametri \\(\\alpha, \\beta > 0\\) ed \\(n \\in \\mathbb{N}\\) di è una variabile aleatoria discreta \\(X\\) è tale che\n\\[\n\\mathbb{P}(X = k) = \\binom{n}{k}\\frac{\\mathcal{B}(k+\\alpha,n-k+\\beta)}{\\mathcal{B}(\\alpha,\\beta)},\\qquad k=0,\\dots,n.\n\\] dove \\(\\mathcal{B}\\) è la funzione beta.\n\nSi definiscano la funzione di probabilità dbetabinom(k, n, alpha, beta) e la funzione di ripartizione pbetabinom(k, n, alpha, beta) di una distribuzione beta-binomiale.\nSi controlli empiricamente che per \\(n = 40\\) e \\(\\alpha = \\beta = 2\\) le probabilità descritte nell’equazione precedente sommano a uno. Quindi, si rappresenti graficamente la distribuzione.\nUtilizzando i parametri del punto precedente, si calcolino numericamente media e varianza di \\(X\\)."
  },
  {
    "objectID": "exe/es_3.html#esercizio-g",
    "href": "exe/es_3.html#esercizio-g",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizio G",
    "text": "Esercizio G\nCalcolare tramite simulazione il valore di\n\\[\\mathbb{E}\\left(e^{-|x|^3}\\right), \\quad X \\sim \\text{N}(0,1).\\]"
  },
  {
    "objectID": "exe/es_3.html#esercizio-h",
    "href": "exe/es_3.html#esercizio-h",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizio H",
    "text": "Esercizio H\nSia \\(X\\) una variabile casuale e sia \\(g(\\cdot)\\) una funzione a valori non negativi. Allora, per ogni \\(k > 0\\)\n\\[\n\\mathbb{P}(g(X) \\ge k) \\le \\frac{\\mathbb{E}(g(X))}{k}.\n\\]\n\nSi verifichi tramite simulazione la disugaglianza di Markov nel caso \\(g(x) = x^2\\) e con \\(X \\sim \\text{N}(0,1)\\), per \\(k = 1,2,3\\). Si confronti il risultato con i valori teorici.\nSi verifichi tramite simulazione la disugaglianza di Markov nel caso \\(g(x) = e^{x/100}\\) e con \\(X \\sim \\text{Ga}(10,1/10)\\), per \\(k = 1,2,3\\)."
  },
  {
    "objectID": "exe/es_3.html#esercizio-i",
    "href": "exe/es_3.html#esercizio-i",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizio I",
    "text": "Esercizio I\nIn un’aula universitaria sono presenti \\(50\\) persone, tutte nate nello stesso anno (non bisestile). Si supponga che la distribuzione del giorno del compleanno sia una distribuzione uniforme discreta nei valori \\(1,\\dots,365\\) e che le date di compleanno delle persone presenti possano essere considerate variabili aleatorie indipendenti.\nUsando la funzione duplicated ed i cicli for di R:\n\nSi calcoli la probabilità che due persone siano nate nello stesso giorno tramite simulazione.\nNell’ora successiva sono presenti in aula \\(25\\) persone. Si ricacolino le probabilità del punto precedente.\nSi scriva quindi del codice R che fa uso della funzione replicate al posto dei cicli for e si ri-ottengano i risultati dei punti precedenti. Ci sono dei miglioramenti in termini di tempo?"
  },
  {
    "objectID": "exe/es_3.html#esercizio-l",
    "href": "exe/es_3.html#esercizio-l",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizio L",
    "text": "Esercizio L\nLa variabile aleatoria \\(X\\) ha distribuzione normale asimmetrica (skew normal) con parametro \\(\\alpha \\in \\mathbb{R}\\) se la sua funzione di densità è pari a\n\\[\nf(x) = 2\\phi(x)\\Phi(\\alpha x), \\qquad x \\in \\mathbb{R}.\n\\] in cui \\(\\phi(x)\\) e \\(\\Phi(x)\\) sono, rispettivamente, la densità e la funzione di ripartizione di una normale standard.\n\nSi scriva la funzione dsn(x, alpha) che calcola la densità \\(f(x)\\).\nSi tracci il grafico di \\(f(x)\\) nell’intervallo \\((-4,4)\\) utilizzando i valori \\(\\alpha = -5, 0, 5\\). Si proponga un’interpretazione per il parametro \\(\\alpha\\).\nSi scriva la funzione rsn(n, alpha) che simula \\(n\\) valori pseudo-casuali da una funzione normale asimmetrica di parametro \\(\\alpha\\) sfruttando la seguente relazione per \\(X\\) \\[\nX = \\sqrt{1 - \\delta^2} Z_1 + \\delta|Z_2|, \\qquad \\delta = \\frac{\\alpha}{\\sqrt{1 + \\alpha^2}}, \\qquad Z_1,Z_2 \\overset{\\text{iid}}{\\sim} \\text{N}(0,1).\n\\]\nSi usi la funzione rsn per simulare \\(10^4\\) valori da una normale asimmetrica di parametro \\(\\alpha = 7\\) e si confronti l’istogramma dei dati simulati con la funzione di densità."
  },
  {
    "objectID": "exe/es_3.html#esercizi-tratti-dai-libro-di-testo-albert-rizzo-ar",
    "href": "exe/es_3.html#esercizi-tratti-dai-libro-di-testo-albert-rizzo-ar",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizi tratti dai libro di testo Albert & Rizzo (AR)",
    "text": "Esercizi tratti dai libro di testo Albert & Rizzo (AR)\n\nEsercizio 13.1, pag 333."
  },
  {
    "objectID": "exe/es_3.html#esercizi-tratti-dai-libro-di-testo-robert-casella-rs",
    "href": "exe/es_3.html#esercizi-tratti-dai-libro-di-testo-robert-casella-rs",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizi tratti dai libro di testo Robert & Casella (RS)",
    "text": "Esercizi tratti dai libro di testo Robert & Casella (RS)\n\nEsercizio 3.3, pag. 111 (difficile)."
  },
  {
    "objectID": "exe/es_4.html",
    "href": "exe/es_4.html",
    "title": "R per l’analisi statistica multivariata",
    "section": "",
    "text": "Siano \\(X_1,\\dots,X_n\\) delle variabili aleatorie indipendenti normali di media \\(\\mu\\) e varianza \\(\\sigma^2\\).\n\nSupponendo che i veri valori siano \\(\\mu = 5\\) e \\(\\sigma^2 = 12\\):\n\nSi verifichi empiricamente se la mediana costituisce uno stimatore consistente per la media \\(\\mu\\). Si tratta di uno stimatore distorto? Si risponda tramite simulazione.\nSi confrontino gli stimatori media aritmetica e la mediana in termini di errore quadratico medio, con \\(n = 30\\). Quale stimatore è preferibile?\nÈ verosimile pensare che lo stimatore mediana abbia una distribuzione asintoticamente normale? Si risponda tramite un’analisi grafica."
  },
  {
    "objectID": "exe/es_4.html#esercizio-b",
    "href": "exe/es_4.html#esercizio-b",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizio B",
    "text": "Esercizio B\nMediante un opportuno studio di simulazione, si mostri che la varianza campionaria e la varianza campionaria corretta sono stimatori consistenti per la varianza della popolazione nel seguente caso:\n\nI dati \\(x_1,\\dots,x_n\\) sono realizzazioni indipendenti da \\(X\\), dove \\(X \\sim \\text{N}(0, 10)\\);"
  },
  {
    "objectID": "exe/es_4.html#esercizio-c",
    "href": "exe/es_4.html#esercizio-c",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizio C",
    "text": "Esercizio C\nL’indice di asimmetria standardizzato per una variabile aleatoria \\(X\\) è definito come\n\\[\n\\gamma = \\mathbb{E}\\left\\{\\left(\\frac{X - \\mu}{\\sigma}\\right)^3\\right\\},\n\\] dove \\(\\mu\\) e \\(\\sigma\\) rappresentano, rispettivamente, media e varianza di \\(X\\). Lo stimatore usuale di \\(\\gamma\\) è\n\\[\n\\hat{\\gamma}_n = \\frac{1}{n}\\sum_{i=1}^n\\left(\\frac{X_i - \\bar{X}}{S}\\right)^3,\n\\] dove \\(\\bar{X} = 1/\\sum_{i=1}^nX_i\\) e \\(S^2 = 1/n\\sum_{i=1}^n(X_i - \\bar{X})^2\\) indicano la media aritmetica e la varianza campionaria (non corretta).\n\nSia \\(X \\sim \\text{N}(3, 10)\\) e si noti che in questo caso \\(\\gamma = 0\\).\n\nLo stimatore \\(\\hat{\\gamma}_n\\) è consistente per \\(\\gamma\\)?\nLo stimatore \\(\\hat{\\gamma}_n\\) è distorto per \\(n = 10\\)? Se si, di quanto?\nA quanto è pari l’errore quadratico medio dello stimatore \\(\\hat{\\gamma}_n\\) se \\(n = 100\\)?\nLa distribuzione di \\(\\hat{\\gamma}_n\\) è approssimativamente normale, per \\(n = 100\\)?\nSi risponda a tutte le domande precedenti assumendo \\(X \\sim \\text{Ga}(10,2)\\) e \\(X \\sim \\text{Logistica}(0,1)\\).\n\nSuggerimenti: Si utilizzi la classe di funzioni *logis. È inoltre lecito utilizzare le pagine di Wikipedia distribuzione Gamma e distribuzione logistica per identificare i corrispettivi indici di asimmetria."
  },
  {
    "objectID": "exe/es_4.html#esercizio-d",
    "href": "exe/es_4.html#esercizio-d",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizio D",
    "text": "Esercizio D\nSiano \\(x_1,\\dots,x_n\\) delle realizzazione indipendenti ed identicamente distribuite da una variabile aleatoria Weibull di parametri \\(\\alpha, \\lambda\\), la cui densità è pari a\n\\[\nf(x; \\alpha, \\lambda) = \\left(\\frac{\\alpha}{\\lambda}\\right)\\left(\\frac{x}{\\lambda}\\right)^{\\alpha - 1}\\exp\\left\\{- \\left(\\frac{x}{\\lambda}\\right)^\\alpha\\right\\}, \\qquad \\alpha > 0, \\quad \\lambda > 0.\n\\] Si consideriano inoltre i dati seguenti:\n\nx <- c(225, 171, 198, 189, 189, 135, 162, 135, 117, 162)\n\n\n\nSi crei in R la funzione loglik(alpha, lambda, x), ovvero la funzione di log-verosimiglianza, pari a \\[\\ell(\\alpha,\\lambda) = \\sum_{i=1}^n\\log f(x_i; \\alpha,\\lambda).\\] Se ritenuto utile, si noti che in R esiste la funzione dweibull.\nUtilizzando la funzione del punto precedente, si calcoli il valore della verosimiglianza quando \\(\\alpha = 6\\) e \\(\\lambda = 200\\).\nNon è possibile calcolare in forma chiusa la stima di massima verosimiglianza \\((\\hat{\\alpha},\\hat{\\lambda})\\). Si utilizzi quindi la funzione nlminb applicata a loglik per ottenerla. Si consulti la documentazione per capire come gestire il caso con due parametri.\nSi rappresentino i dati tramite istogramma e si rappresenti la curva \\(f(x,\\hat{\\alpha},\\hat{\\lambda})\\). La stima ottenuta sembra ragionevole?"
  },
  {
    "objectID": "exe/es_4.html#esercizio-e",
    "href": "exe/es_4.html#esercizio-e",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizio E",
    "text": "Esercizio E\nSiano \\(X_1,X_2, \\ldots,X_n\\) variabili aleatorie iid (indipendenti ed identicamente distribuite) di Poisson di parametro \\(\\lambda\\). Si considerino, inoltre, i seguenti stimatori:\n\\[\nT_1 = \\sum_{i=1}^n X_i, \\qquad T_2 = \\sum_{i=1}^n i \\cdot X_i, \\qquad T_3 = \\frac{1}{n} \\sum_{i=1}^n X_i.\n\\] Supponendo che il vero valore sia \\(\\lambda = 3\\):\n\nSi verifichi empiricamente se costituiscono stimatori consistenti per \\(\\lambda\\). Si tratta di stimatori distorti? Si risponda tramite simulazione.\nSi confrontino gli stimatori in termini di errore quadratico medio, con \\(n = 50\\). Quale stimatore è preferibile?\nÈ verosimile pensare che abbiano distribuzione asintoticamente normale? Si risponda tramite un’analisi grafica."
  },
  {
    "objectID": "exe/es_4.html#esercizio-f",
    "href": "exe/es_4.html#esercizio-f",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizio F",
    "text": "Esercizio F\nSi consideri un campione casuale di \\(n\\) osservazioni da una popolazione normale \\(N(0, \\theta)\\), dove \\(\\theta\\) rappresenta la varianza incognita della variabile aleatoria. Supponendo di avere osservato il seguente campione di \\(10\\) osservazioni:\n\nx <- c(2.52, 0.76, 1.55, 0.98, 4.03, 0.09, -2.27, 1.67, -0.54, -0.27)\n\n\nSi crei in R la funzione loglik(theta, x), ovvero la funzione di log-verosimiglianza, pari al logaritmo della funzione di verosimiglianza \\[\\mathscr{L}(\\theta) = (2\\pi\\theta)^{-n/2} e^{-\\frac{1}{2 \\theta}\\sum_{i=1}^n x_i^2}.\\]\nUtilizzando la funzione del punto precedente, si calcoli il valore della log-verosimiglianza quando \\(\\theta=3\\) e \\(\\theta=5\\). Quale è il valore più “verosimile”?\nSi utilizzi la funzione nlminb applicata a loglik per ottenere la stima di massima verosimiglianza.\nSi rappresentino i dati tramite istogramma e si rappresenti la densità stimata \\(f(x ; 0, \\hat{\\theta})\\). La stima ottenuta sembra ragionevole?"
  },
  {
    "objectID": "exe/es_4.html#esercizio-e-1",
    "href": "exe/es_4.html#esercizio-e-1",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizio E",
    "text": "Esercizio E\nSiano \\(x_1, \\ldots, x_n\\) delle realizzazioni iid da \\(X \\sim \\text{N}(5, 15)\\). Si realizzi uno studio di simulazione che confronti la media campionaria e la media troncata di livello \\(\\alpha = 5\\%\\). Si tratta di stimatori consistenti per la media della popolazione?\nLa media troncata non considera le prime ed ultime \\(k\\) osservazioni, dove \\(k = n \\cdot\\alpha\\) (approssimato all’intero più vicino). Se \\(x_{(1)},\\dots,x_{(n)}\\) è il campione ordinato, la media troncata è quindi definita come\n\\[\n\\hat{\\mu}_\\text{tr} = \\frac{1}{n - 2 k } \\sum_{i=k+1}^{n-k} x_{(i)}.\n\\] In R si può usare il comando mean(x, trim = alpha)."
  },
  {
    "objectID": "exe/es_4.html#esercizi-tratti-dai-libro-di-testo-albert-rizzo-ar",
    "href": "exe/es_4.html#esercizi-tratti-dai-libro-di-testo-albert-rizzo-ar",
    "title": "R per l’analisi statistica multivariata",
    "section": "Esercizi tratti dai libro di testo Albert & Rizzo (AR)",
    "text": "Esercizi tratti dai libro di testo Albert & Rizzo (AR)\n\nEsercizio 13.2, pag 334.\nEsercizio 13.3, pag 334."
  },
  {
    "objectID": "esami/esame_04_02_2022.html",
    "href": "esami/esame_04_02_2022.html",
    "title": "R per l’analisi statistica multivariata",
    "section": "",
    "text": "Si carichi in memoria il dataset birthwt della libreria MASS. Il dataset si riferisce a \\(n = 189\\) donne in gravidanza. Si consiglia di consultare la documentazione per la descrizione delle variabili coinvolte.\n\n(1pt) Si aggiunga al dataset birthwt la nuova variabile qualitativa age_class, la quale suddivide i valori della variabile age in 3 classi: low (età comprese tra 14 e 22), medium (età comprese tra 23 e 28) e high (età \\(\\ge 29\\)).\n(1pt) Si ottengano le frequenze assolute della variabile age_class.\n(2pt) La variabile bwt è espressa in grammi. La si converta in chilogrammi, sovrascrivendo quella presente nel dataset birthwt. Se ne faccia quindi un istogramma, considerando un numero di classi appropriato.\n(1pt) Si confrontino i tre boxplot della variabile bwt (espressa in chilogrammi) condizionatamente a ciascuna modalità della variabile age_class.\n(1pt) Si crei un nuovo dataset, chiamato birthwt_no_smoke contenente esclusivamente i valori delle donne non-fumatrici e si esegua la stessa analisi condotta al punto precedente. Suggerimento: si consulti la documentazione del dataset.\n(4pt) Si consideri nuovamente il dataset birthwt. Si costruisca una matrice \\(\\textbf{X}\\) di dimensione \\(n \\times 3\\) le cui colonne sono i vettori \\(x_1, x_2, x_3\\), ciascuno di dimensione \\(n \\times 1\\). Più precisamente, il primo vettore colonna è pari a \\(x_1 = (1,\\dots,1)^T\\), mentre i vettori colonna \\(x_2\\) ed \\(x_3\\) contengono i valori delle variabili age e ftv. Inoltre, il vettore colonna \\(y\\) contiene i valori della variabile bwt. Si ottenga il vettore \\(\\beta\\) di dimensione \\(3 \\times 1\\), definito come segue: \\[\n\\hat{\\beta} = (\\textbf{X}^T\\textbf{X})^{-1} \\textbf{X}^T y,\n\\] la cui utilità ed interpretazione risulterà chiara in corsi successivi."
  },
  {
    "objectID": "esami/esame_04_02_2022.html#problema-2",
    "href": "esami/esame_04_02_2022.html#problema-2",
    "title": "R per l’analisi statistica multivariata",
    "section": "Problema 2",
    "text": "Problema 2\nSiano \\(p_1(x)\\) e \\(p_2(x)\\) due funzioni di probabilità relative a due variabili aleatorie discrete \\(X_1,X_2\\) aventi lo stesso supporto \\(\\mathcal{S} = \\{x_1,\\dots, x_k\\}\\). La divergenza di Kullback-Leibler di \\(X_1\\) da \\(X_2\\) è definita come segue\n\\[\n\\text{KL}(p_1 \\mid \\mid p_2) = \\sum_{j=1}^k p_1(x_j) \\log\\left\\{\\frac{p_1(x_j) }{p_2(x_j) }\\right\\}.\n\\]\n\n(3pt) Si supponga che \\(X_1, X_2\\) siano due distribuzioni binomiali di parametro \\(n = 20\\) e differenti probabilità di successo \\(\\theta_1 = 0.5\\) e \\(\\theta_2 = 0.2\\). Si calcoli la divergenza di Kullback-Leibler di \\(X_1\\) da \\(X_2\\).\n(3pt) Si noti che: \\[\n\\text{KL}(p_1 \\mid \\mid p_2) = E\\left[\\log\\left\\{\\frac{p_1(X_1) }{p_2(X_1) }\\right\\}\\right].\n\\] Si sfrutti questo risultato per ottenere una stima Monte Carlo della divergenza di KL del punto precedente. Si quantifichi inoltre l’errore commesso.\n(4pt) Siano \\(X_1, X_2\\) due distribuzioni Poisson di media \\(\\lambda_1\\) e \\(\\lambda_2\\). In questo caso la dimensione del supporto è \\(k = \\infty\\) e pertanto la definizione di divergenza di KL di \\(X_1\\) da \\(X_2\\) coinvolge una somma infinita. Si proponga una strategia appropriata per ottenere la divergenza KL e la si calcoli per \\(\\lambda_1 = 1\\) e \\(\\lambda_2 = 4\\)."
  },
  {
    "objectID": "esami/esame_04_02_2022.html#problema-3",
    "href": "esami/esame_04_02_2022.html#problema-3",
    "title": "R per l’analisi statistica multivariata",
    "section": "Problema 3",
    "text": "Problema 3\nSiano \\(y = (y_1,\\dots,y_n)\\) delle realizzazioni iid di una variabile aleatoria discreta con legge bernoulli di parametro \\(\\theta \\in (0,1)\\). La funzione di log-verosimiglianza, a meno di una costante additiva, è pari a\n\\[\n\\ell(\\theta) = \\ell(\\theta; y) = \\sum_{i=1}^ny_i\\log\\theta + \\sum_{i=1}^n(1 - y_i)\\log(1-\\theta).\n\\]\n\n(2pt) Si implementi la funzione loglik(theta, y) che calcola la funzione di log-verosimiglianza.\n(2pt) Si considerino le osservazioni 0, 0, 1, 0, 0, 0, 0, 1. Si disegni la funzione di log-verosimiglianza corrispondente nell’intervallo \\((0, 1)\\).\n(2pt) Utilizzando opportuni strumenti di approssimazione numerica si calcoli la stima di massima verosimiglianza \\(\\hat{\\theta}\\).\n(2pt) L’approssimazione parabolica della funzione di log-verosimiglianza, nel suo punto di massimo, è la seguente \\[\n\\ell(\\theta) \\approx \\ell(\\hat{\\theta}) - \\frac{n}{2 \\hat{\\theta}(1 - \\hat{\\theta})}(\\theta - \\hat{\\theta})^2.\n\\] Si implementi la funzione loglik_approx(theta, y) che calcola tale approssimazione, sapendo che \\(\\hat{\\theta} = \\bar{y}\\). Si confrontino graficamente la log-verosimiglianza e la sua approssimazione in \\((1/10, 1/2)\\), utilizzando i dati forniti in precedenza.\n(2pt) Si considerino le osservazioni 0, 0, 0, 0, 0, 0, 0, 0. Si disegni la funzione di log-verosimiglianza nell’intervallo \\((0, 1)\\) e si calcoli la stima di massima verosimiglianza \\(\\hat{\\theta}\\). Si provi quindi a disegnare l’approssimazione quadratica della verosimiglianza. Si commentino i risultati e/o eventuali errori."
  },
  {
    "objectID": "esami/sim_esame2020.html",
    "href": "esami/sim_esame2020.html",
    "title": "R per l’analisi statistica multivariata",
    "section": "",
    "text": "Sia \\(X\\) una variabile casuale uniforme discreta avente supporto sugli interi da \\(1\\) a \\(365\\). Si assuma che il supporto di \\(X\\) sia associato ad ognuno dei giorni dell’anno (non bisestile); in particolare, \\(1\\) indica il primo Gennaio, mentre \\(365\\) il 31 Dicembre.\n\n\nA partire da queste informazioni si imposti uno studio di simulazione basato su \\(30000\\) repliche per stimare la probabilità che in un gruppo di \\(39\\) persone tutte siano nate in giorni diversi.\nSi stimi la probabilità dell’evento al punto precedente sotto l’ipotesi che nei primi \\(35\\) giorni dell’anno la probabilità di nascere sia doppia rispetto agli altri giorni dell’anno; si utilizzi lo stesso numero di repliche del punto precedente."
  },
  {
    "objectID": "esami/sim_esame2020.html#problema-2",
    "href": "esami/sim_esame2020.html#problema-2",
    "title": "R per l’analisi statistica multivariata",
    "section": "Problema 2",
    "text": "Problema 2\nÈ noto che per generare numeri pseudo-casuali da una variabile casuale continua \\(Z\\) è sufficiente avere a disposizione un generatore di numeri pseudo-casuali da una variabile uniforme continua nell’intervallo \\([0,1]\\).\nInfatti, si ha \\(z_\\text{pc} = F^{-1}_Z(u_\\text{pc})\\) in cui \\(z_\\text{pc}\\) è un numero pseudo-casuale da \\(Z\\), \\(u_\\text{pc}\\) è un numero pseudo-casuale da una variabile casuale uniforme in \\([0,1]\\) e \\(F^{−1}_Z(\\cdot)\\) è l’inversa della funzione di ripartizione di \\(Z\\), ovvero la funzione quantile.\nSi supponga che \\(Z\\) sia una variabile casuale continua con funzione di ripartizione \\[\nF(z) = \\frac{e^z}{1 + e^z}.\n\\] Si generino, secondo la definizione \\(F^{-1}_Z(u_\\text{pc})\\), \\(10000\\) numeri pseudo-casuali da \\(Z\\). Quindi, utilizzando i numeri pseudo-casuali generati al punto precedente, si approssimino:\n\nIl valore atteso \\(\\mathbb{E}(Z)\\)\nLa varianza \\(\\text{var}(Z)\\)\nLa probabilità che \\(Z\\) sia compresa tra \\(1\\) e \\(2\\)."
  },
  {
    "objectID": "esami/sim_esame2020.html#problema-3",
    "href": "esami/sim_esame2020.html#problema-3",
    "title": "R per l’analisi statistica multivariata",
    "section": "Problema 3",
    "text": "Problema 3\nNel file auto.txt disponibile al link https://tommasorigon.github.io/introR/data/auto.txt si riportano dati relativi ad alcuni modelli di autobili presenti in commercio negli Stati Uniti tra il 1973 e il 1974. Le variabili presenti nell’insieme di dati fornito sono\n\nmpg: consumo (miglia / galloni)\ncyl: numero di cilindri\ndisp: cilindrata (pollici cubici)\nhp: cavalli\ndrat: rapporto ase posteriore/anteriore\nwt: peso (in libbre)\nqsec: tempo a percorrere 1/4 di miglio con partenza da fermo\nvs: disposizione dei cilindri (0 = a V, 1 = in linea)\nam: cambio (0 = automatico, 1 = manuale)\ngear: numero di marce\ncarb: numero di carburatori\n\n\nUna volta caricati i dati in R:\n\nIndicare la classe dell’oggetto importato.\nIndicare il numero di righe e colonne dell’oggetto importato.\nIndicare la classe della variabile vs: se diversa da factor, convertirla e rinominare opportunamente i livelli come V e Linea.\nCalcolare le frequenze relative di cyl condizionate a gear=3.\nDire se è corretto affermare che “il \\(60\\)-simo percentile della distribuzione dei cavalli delle auto con disposizione dei cilindri a V è maggiore rispetto al numero medio di cavalli delle auto con disposizione dei cilindri in linea”."
  },
  {
    "objectID": "esami/esame_08_02_2021.html",
    "href": "esami/esame_08_02_2021.html",
    "title": "R per l’analisi statistica multivariata",
    "section": "",
    "text": "La funzione \\(f(x)\\) è definita come segue\n\\[\nf(x) = \\frac{e^x - 1}{1 + e^x}.\n\\]\n\nSi scriva in R la funzione f(x) associata ad \\(f(x)\\).\nSi calcoli il valore di \\(f(x)\\) nel punto \\(x = 4\\).\nSi approssimi il valore di \\(f(4)\\) alla seconda cifra decimale utilizzando il comando R appropriato.\nSi faccia il grafico di \\(f(x)\\) nell’intervallo \\((-2, 4)\\).\nSi calcolino i valori delle seguenti sommatorie: \\[\\sum_{k=5}^{10} \\frac{e^k - 1}{1 + e^k},\\] \\[\\sum_{k=5}^{100} \\frac{e^k - 1}{1 + e^k}.\\]\nUtilizzando la funzione integrate di R, si calcoli numericamente il valore dell’integrale\n\n\\[\n\\int_1^4\\frac{e^x - 1}{1 + e^x} \\mathrm{d}x.\n\\]"
  },
  {
    "objectID": "esami/esame_08_02_2021.html#problema-2",
    "href": "esami/esame_08_02_2021.html#problema-2",
    "title": "R per l’analisi statistica multivariata",
    "section": "Problema 2",
    "text": "Problema 2\nSi consideri il dataset di R Pima.te presente nella libreria MASS. Se ne consulti la documentazione per ulteriori informazioni.\n\nQuante osservazioni sono contenute nel dataset Pima.te? Quante variabili sono presenti?\nSi calcoli la media aritmetica della pressione sanguigna (variabile bp).\nLa variabile bmi rappresenta il “body mass index”. Si crei la variabile bmi_log, contenente il logaritmo della variabile bmi. Si ottenga un istogramma di bmi_log, scegliendo opportunamente il numero di intervalli.\nSi scriva la funzione R asym(x) che calcola il coefficiente di asimmetria secondo Pearson, definito come \\[\n\\gamma = \\frac{1}{\\text{sqm}(x)^3} \\frac{1}{n}\\sum_{i=1}^n(x_i - \\bar{x})^3,\\] per dei dati \\(x_1,\\dots,x_n\\) aventi media \\(\\bar{x}\\). Per calcolare lo scarto quadratico medio \\(\\text{sqm(x)}\\) si faccia uso della funzione sd.\nSi calcoli il coefficiente di asimmetria secondo Pearson per le variabili bmi e bmi_log. Quale delle due variabili risulta maggiormente asimmetrica?\nÈ ragionevole supporre i dati della variabile bmi provengano una distribuzione gaussiana? E i dati di bmi_log? Si risponda tramite strumenti grafici.\nSi creino le variabili bmi_yes e bmi_no, contenenti rispettivamente i valori della variabile bmi per le donne aventi il diabete (type = Yes) e per le donne non aventi il diabete (type = No).\nSi confrontino le funzioni di ripartizioni empiriche delle variabili bmi_yes e bmi_no. Inoltre, si calcolino media e mediana delle variabili bmi_yes e bmi_no."
  },
  {
    "objectID": "esami/esame_08_02_2021.html#problema-3",
    "href": "esami/esame_08_02_2021.html#problema-3",
    "title": "R per l’analisi statistica multivariata",
    "section": "Problema 3",
    "text": "Problema 3\nSe \\(x_1,\\dots,x_n\\) sono un campione casuale semplice (iid) con numerosità \\(n\\) tratto da una distribuzione \\(\\text{Ga}(\\alpha,\\lambda)\\), allora la funzione di log-verosimiglianza è pari a\n\\[\n\\ell(x;\\alpha, \\lambda) = \\sum_{i=1}^n\\log{f(x_i; \\alpha, \\lambda)}, \\qquad  f(x; \\alpha, \\lambda) = \\frac{\\lambda^\\alpha}{\\Gamma(\\alpha)}x^{\\alpha-1}e^{-\\lambda x}.\n\\] Se \\(\\alpha\\) è noto, allora la stima di massima verosimiglianza per \\(\\lambda\\) è pari a \\[\\hat{\\lambda} = \\frac{n \\alpha}{\\sum_{i=1}^n x_i}.\\] Si supponga di aver osservato le seguenti \\(6\\) osservazioni da una distribuzione gamma di parametri \\(\\alpha = 2\\) e \\(\\lambda > 0\\). Il parametro \\(\\lambda\\) è ignoto e siamo interessati ad una sua stima.\n\n# Vettore delle osservazioni\nx <- c(2.1499496, 5.0539201, 3.1207749, 1.4512639, 3.8040806, 1.6647759)\n\n\nSi ottenga la stima di massima verosimiglianza per \\(\\lambda\\) con i dati a disposizione e supponendo \\(\\alpha = 2\\).\nSi scriva una funzione R loglik(x, alpha, lambda) che calcola la funzione di log-verosimiglianza.\nSi ottenga il valore della log-verosimiglianza \\(\\ell(x; 2, 1)\\). Si verifichi che tale valore è minore di \\(\\ell(x; 2, \\hat{\\lambda})\\) e se ne spieghi il motivo.\nSi “verifichi” tramite simulazione la consistenza dello stimatore di massima verosimiglianza per \\(\\lambda\\), quando \\(\\alpha\\) è noto. Per fare ciò, si ottengano le stime di massima verosimiglianza di \\(4\\) campioni simulati aventi numerosità \\(n = 100, 500, 1000, 10000\\), campionando da una distribuzione gamma di parametri \\((\\alpha, \\lambda) = (2, 1)\\)."
  },
  {
    "objectID": "esami/esame_19_11_2021.html",
    "href": "esami/esame_19_11_2021.html",
    "title": "R per l’analisi statistica multivariata",
    "section": "",
    "text": "Si carichi in memoria il dataset Boston tramite il comando data(Boston) dopo aver caricato in memoria la libreria MASS.\n\n(1pt) Si crei un vettore numerico x contenente i valori della variabile crim del dataset Boston. Si calcolino media e mediana di tale variabile.\n(1pt) Si creino i vettori x_river e x_no_river contenenti i valori della variabile crim, rispettivamente per le osservazioni vicine al fiume (chas = 1) e lontane dal fiume (chas = 0).\n(4pt) Siano \\(x_1,\\dots,x_n\\) delle osservazioni numeriche. La differenza semplice media è un indicatore di variabilità definito come segue \\[\n\\Delta = \\frac{1}{n(n-1)} \\sum_{i=1}^n\\sum_{j=1}^n |x_i - x_j|.\n\\] Si definisca in R la funzione delta(x) che calcola l’indicatore \\(\\Delta\\) per un generico vettore numerico x. Si calcoli quindi tale indicatore per le variabili x_river e x_no_river.\n(4pt) Sia \\(x_{(1)}, \\dots, x_{(n)}\\) il campione ordinato dei dati \\(x_1,\\dots,x_n\\) e sia \\(\\bar{x}\\) la media aritmetica. La differenza semplice media ammette una rappresentazione alternativa, pari a: \\[\n\\Delta = \\frac{4}{n(n-1)}\\left( \\sum_{i=1}^n i x_{(i)}\\right) - 2\\bar{x} \\frac{n+1}{n-1}.\n\\] Si definisca in R la funzione delta2(x) che calcola l’indicatore \\(\\Delta\\) tramite questa formula alternativa. Si calcoli quindi tale indicatore per le variabili x_river e x_no_river e si verifichi che il risultato coincide con quello trovato al punto precedente."
  },
  {
    "objectID": "esami/esame_19_11_2021.html#problema-2",
    "href": "esami/esame_19_11_2021.html#problema-2",
    "title": "R per l’analisi statistica multivariata",
    "section": "Problema 2",
    "text": "Problema 2\nUno studente del corso di laurea SSE dell’Università Milano-Bicocca sostiene di aver inventato una nuova variabile aleatoria. Pur non conoscendone la densità, definisce la variabile aleatoria \\(X\\) come segue:\n\\[\nX = \\sqrt{ - 2 \\log{U_1}} \\sin{(2\\pi U_2)},\n\\] dove \\(U_1\\) ed \\(U_2\\) sono due variabile aleatorie uniformi in \\((0,1)\\) ed indipendenti tra loro.\n\n(2pt) Si scriva in R la funzione r_log_sin(R) che simula R valori pseudo-casuali distribuiti come la variabile \\(X\\).\n(2pt) Si fornisca un’approssimazione delle quantità \\(E(X)\\) e \\(E(X^2)\\).\n(2pt) Si quantifichi l’errore commesso al punto precedente.\n(2pt) Si approssimino le probabilità \\(P(X \\le x)\\), per \\(x = -1, 0, 1\\).\n(2pt) Si ottenga una stima della densità di \\(X\\). Sulla base di quest’ultima stima e di tutti gli indicatori precedenti, a cosa “assomiglia” la distribuzione di \\(X\\)?"
  },
  {
    "objectID": "esami/esame_19_11_2021.html#problema-3",
    "href": "esami/esame_19_11_2021.html#problema-3",
    "title": "R per l’analisi statistica multivariata",
    "section": "Problema 3",
    "text": "Problema 3\nSiano \\(y = (y_1,\\dots,y_n)\\) delle realizzazioni iid di una variabile aleatoria continua con legge Laplace, la cui densità è\n\\[\nf(y ; \\theta) = \\frac{1}{2}e^{-|y - \\theta|}.\n\\]\nDi conseguenza, la funzione di log-verosimiglianza, a meno di una costante additiva, è pari a\n\\[\n\\ell(\\theta) = \\ell(\\theta; y) = - \\sum_{i=1}^n |y_i - \\theta|.\n\\]\n\n(3pt) Si scriva la funzione loglik(theta, y) che calcola la funzione di log-verosimiglianza. Ci si assicuri che la funzione sia opportunamente ``vettorizzata” rispetto a \\(\\theta\\).\n(3pt) Si considerino le osservazioni 10, 3, 12, 20, 32, 8. Si disegni la funzione di log-verosimiglianza corrispondente nell’intervallo \\((0, 30)\\).\n(3pt) Utilizzando opportuni strumenti di approssimazione numerica si calcoli la stima di massima verosimiglianza \\(\\hat{\\theta}\\).\n(2pt) Si calcoli il valore della log-verosimiglianza nel punto di massimo e la si confronti con il valore \\(\\ell(10 + \\pi/4)\\). Si commentino i risultati."
  },
  {
    "objectID": "esami/esame_22_07_2021.html",
    "href": "esami/esame_22_07_2021.html",
    "title": "R per l’analisi statistica multivariata",
    "section": "",
    "text": "Si supponga che \\(X\\) sia una variabile casuale che si distribuisce come un’esponenziale di media \\(1/2\\). Inoltre, sia \\(Y\\) una variabile casuale tale che \\(Y\\) condizionata a \\(X = x\\) si distribuisce come una Poisson di media \\(\\exp(x / 4).\\)\n\n(5pt) Calcolare via simulazione il valore atteso \\(E(Y^2)\\).\n\nGrazie alle proprietà della distribuzione di Poisson, si ottiene che\n\\[\nE(Y^2 \\mid X = x) = e^{x/4} + e^{x / 2}.\n\\]\n\n(5pt) Si sfrutti questo risultato per ottenere una stima alternativa (ma equivalente) del valore atteso \\(E(Y^2)\\)."
  },
  {
    "objectID": "esami/esame_22_07_2021.html#problema-2",
    "href": "esami/esame_22_07_2021.html#problema-2",
    "title": "R per l’analisi statistica multivariata",
    "section": "Problema 2",
    "text": "Problema 2\nSia \\(X\\) una variabile casuale distribuita in modo uniforme nell’intervallo \\((\\theta / 2, \\theta)\\), con \\(\\theta > 0\\). Sia \\(X_1,\\dots,X_n\\) un campione casuale da \\(X\\) e siano dati i due stimatori\n\\[\nT_1 = \\frac{4}{3}\\bar{X}, \\qquad T_2 = \\frac{2}{3}(X_{(1)} + X_{(n)}),\n\\] dove \\(X_{(1)}\\) e \\(X_{(n)}\\) rappresentano il minimo ed il massimo di \\(X_1,\\dots,X_n\\), rispettivamente. Supponendo \\(\\theta = 1\\) e \\(n = 20\\), si ottenga una stima Montecarlo delle seguenti quantità:\n\n(2pt) La distorsione degli stimatori \\(T_1\\) e \\(T_2\\), ovvero \\(E(T_1 - \\theta)\\) e \\(E(T_2 - \\theta)\\).\n(2pt) L’errore quadratico medio di \\(T_1\\) e \\(T_2\\), ovvero \\(E\\{(T_1 - \\theta)^2\\}\\) e \\(E\\{(T_2 - \\theta)^2\\}\\). Quale dei due stimatori risulta più efficiente?\n\nInoltre, supponendo \\(\\theta = 1\\)\n\n(6pt) Si conduca uno studio di simulazione e si verifichi empiricamente che lo stimatore \\(T_1\\) è consistente al crescere di \\(n\\)."
  },
  {
    "objectID": "esami/esame_22_07_2021.html#problema-3",
    "href": "esami/esame_22_07_2021.html#problema-3",
    "title": "R per l’analisi statistica multivariata",
    "section": "Problema 3",
    "text": "Problema 3\nSi considerino i dati sono disponibili al link https://tommasorigon.github.io/introR/data/province.csv\n\n(1pt) Si carichino i dati in memoria. Quante osservazioni sono presenti? Quante variabili?\n(1pt) Si ottenga la matrice di correlazione.\n(8pt) Si calcoli la correlazione parziale tra le variabili agricoltura e feritilità al netto della variabile istruzione, che si ottiene come segue. Si costruisca un modello di regressione lineare usando “agricoltura” come variabile risposta (\\(y\\)) e “istruzione” (\\(x\\)) come variabile esplicativa. Analogamente, si costruisca un modello di regressione usando “fertilità” come variabile risposta e “istruzione” come variabile esplicativa. Si ricordi che le stime ai minimi quadrati sono pari a \\[\n\\hat{\\alpha} = \\bar{y} - \\hat{\\beta}\\bar{x}, \\qquad \\hat{\\beta} = \\frac{\\text{cov}(x,y)}{\\text{var}(x)}.\n\\] Il coefficiente di correlazione parziale si ottiene quindi calcolando coefficiente di correlazione tra i residui di entrambi i modelli"
  },
  {
    "objectID": "esami/esiti.html",
    "href": "esami/esiti.html",
    "title": "R per l’analisi statistica multivariata",
    "section": "",
    "text": "Matricola\nEsito\n\n\n\n\n795145\nINS\n\n\n826036\nINS\n\n\n832344\n27\n\n\n832450\n18\n\n\n837297\n24\n\n\n837363\n20\n\n\n850960\nINS\n\n\n851007\nINS\n\n\n851534\nINS\n\n\n852054\nINS\n\n\n852225\nINS\n\n\n856942\nINS\n\n\n857880\n26\n\n\n861300\nINS\n\n\n861837\n19\n\n\n864426\n18\n\n\n864920\nINS\n\n\n864973\nINS\n\n\n865257\nINS\n\n\n865309\n25\n\n\n865336\n27\n\n\n865374\n21\n\n\n870789\n26\n\n\n871277\nINS\n\n\n871794\n18\n\n\n873133\nINS\n\n\n873335\nINS\n\n\n874624\n18\n\n\n874883\nINS\n\n\n875967\n22\n\n\n876170\n30"
  },
  {
    "objectID": "esami/esame_30_06_2021.html",
    "href": "esami/esame_30_06_2021.html",
    "title": "R per l’analisi statistica multivariata",
    "section": "",
    "text": "La cosiddetta \\(\\mathcal{D}\\) di Cohen è una statistica descrittiva molto utilizzata in Psicologia. Siano \\(x_1,\\dots,x_{n_x}\\) e \\(y_1,\\dots,y_{n_y}\\) due insieme di dati con numerosità campionarie \\(n_x\\) ed \\(n_y\\), rispettivamente. Siamo interessati a stabilire se questi due insiemi differiscono in media in maniera sostanziale. A tal fine, definiamo la \\(\\mathcal{D}\\) di Cohen come segue:\n\\[\n\\mathcal{D} = \\frac{|\\bar{x} - \\bar{y}|}{s}, \\qquad \\text{dove} \\qquad \\bar{x} = \\frac{1}{n_x}\\sum_{i=1}^{n_x}x_i, \\qquad \\bar{y} = \\frac{1}{n_y}\\sum_{i=1}^{n_y}y_i,\n\\]\nin cui \\(s > 0\\) è una misura della variabilità dei dati. Assumendo che la variabilità sia uguale tra le due popolazioni di dati, è ragionevole porre ad esempio\n\\[\ns^2 = \\frac{1}{n_x + n_y - 2}\\left\\{\\sum_{i=1}^{n_x}(x_i - \\bar{x})^2 + \\sum_{i=1}^{n_y}(y_i - \\bar{y})^2  \\right\\}.\n\\]\nL’ammontare della differenza tra le medie è spesso detta “debole” se \\(\\mathcal{D} \\approx 0.2\\), “media” se \\(\\mathcal{D} \\approx 0.5\\) e “forte” se \\(\\mathcal{D} \\approx 0.8\\). Si considerino inoltre i seguenti insiemi di dati\n\nx <- c(7.19, 8.27, 6.77, 6.65, 8.56, 6.56, 6.09)\ny <- c(6.37, 6.27, 7.95, 6.52, 7.72, 6.92, 6.34, 7.51, 6.07, 8.09, 6.03)\n\n\n(3pt) Si scriva in R la funzione cohenD(x, y) che calcola l’indicatore \\(\\mathcal{D}\\) di Cohen.\n(1pt) Utilizzando i dati forniti, si calcoli la \\(\\mathcal{D}\\) di Cohen associata.\n(1pt) Si generino due insiemi dati \\(x_1,\\dots,x_{n_x}\\) e \\(y_1,\\dots,y_{n_y}\\) campionando dei valori indipendenti da una distribuzione normale con media e varianza \\(N(0, 100)\\) e con \\(n_x = 500\\) e \\(n_y = 2000\\). Si calcoli quindi la \\(\\mathcal{D}\\) di Cohen associata. Il valore trovato suggerisce una differenza tra le medie “debole”?\n(1pt) Si generino due insiemi dati \\(x_1,\\dots,x_{n_x}\\) e \\(y_1,\\dots,y_{n_y}\\) campionandi dei valori indipendenti dalle distribuzioni normali \\(N(0, 100)\\) e \\(N(10, 100)\\), rispettivamente per le variabili \\(x\\) ed \\(y\\), supponendo anche in questo caso che \\(n_x = 500\\) e \\(n_y = 2000\\). Si calcoli quindi la \\(\\mathcal{D}\\) di Cohen. Il valore trovato suggerisce una differenza tra le medie “debole”?\n(4pt) Si effetti uno studio di simulazione nel quale i dati \\(x\\) ed \\(y\\) vengono generati varie volte come fatto nel punto precedente. Per ciascuna coppia di insiemi di dati \\(x\\) ed \\(y\\), si calcoli la \\(\\mathcal{D}\\) di Cohen associata. Si ripeta questa operazione R = 1000 volte, ottenendo quindi un vettore di dimensione 1000 che comprende i vari indici \\(\\mathcal{D}\\) di Cohen. Si disegni un istogramma di tali valori."
  },
  {
    "objectID": "esami/esame_30_06_2021.html#problema-2",
    "href": "esami/esame_30_06_2021.html#problema-2",
    "title": "R per l’analisi statistica multivariata",
    "section": "Problema 2",
    "text": "Problema 2\nSi ponga \\(X_1 = 1\\). Si consideri una collezione di variabile casuali binarie ed indipendenti \\(X_1,\\dots,X_n\\), tali per per cui\n\\[\n\\text{P}(X_i = 1) = \\frac{\\alpha}{\\alpha + i - 1}, \\qquad i = 2,\\dots,n,\n\\]\ndove \\(\\alpha > 0\\) è un parametro positivo. Inoltre, si definisca\n\\[\nS = \\sum_{i=1}^n X_i.\n\\] Nota. La variabile \\(S\\) non si distribuisce come una binomiale, essendo somma di variabili Bernoulli con probabilità differenti.\n\n(4pt) Si scriva in R la funzione rS(R, n, alpha) che simula un R valori pseudo-casuali distribuiti come la variable \\(S\\).\n(2pt) Utilizzando \\(n = 100\\) e \\(\\alpha = 1\\), si ottenga una stima Monte Carlo del valore atteso \\(\\text{E}(S)\\), utilizzando un numero di repliche R appropriato.\n(2pt) Utilizzando \\(n = 500\\) e \\(\\alpha = \\pi / 4\\), si ottenga una stima Monte Carlo dell’evento \\(\\text{P}(3 \\le S \\le 5)\\), utilizzando un numero di repliche R appropriato.\n(2pt) 1. Utilizzando \\(n = 500\\) e \\(\\alpha = \\sqrt{2}\\), si ottenga una stima Monte Carlo della distribuzione di \\(S\\) e se ne faccia un grafico, utilizzando un numero di repliche R appropriato."
  },
  {
    "objectID": "esami/esame_30_06_2021.html#problema-3",
    "href": "esami/esame_30_06_2021.html#problema-3",
    "title": "R per l’analisi statistica multivariata",
    "section": "Problema 3",
    "text": "Problema 3\nSi consideri il dataset Animals della libreria MASS e lo si carichi in memoria.\n\n(1pt) Si ottengano le variabili lbody e lbrain, corrispondenti al logaritmo naturale delle variabili body e brain del dataset Animals, rispettivamente.\n(1pt) Si ottengano le medie campionarie e le mediane per le variabili lbody e lbrain. Si ottengano quindi il primo ed il terzo quartile. Sono presenti outlier nelle due distribuzioni?\n(2pt) Si ottengano gli istogrammi di tali variabili, scegliendo opportunamente il numero di intervalli.\n(1pt) Si ottenga un grafico che metta in relazione le variabili lbody e lbrain.\n(1pt) Si calcoli la correlazione tra le variabili lbody e lbrain.\n(4pt) In un modello di regressione lineare semplice \\(y = \\alpha + \\beta x\\), dove lbody rappresenta la variabile esplicativa (\\(x\\)) e lbrain rappresenta la variabile risposta (\\(y\\)), si ottengano le stime ai minimi quadrati, le quali sono pari a \\[\n\\hat{\\alpha} = \\bar{y} - \\hat{\\beta}\\bar{x}, \\qquad \\hat{\\beta} = \\frac{\\text{cov}(x,y)}{\\text{var}(x)}.\n\\]"
  },
  {
    "objectID": "esami/esame_20_11_2020.html",
    "href": "esami/esame_20_11_2020.html",
    "title": "R per l’analisi statistica multivariata",
    "section": "",
    "text": "Dopo aver caricato in memoria la libreria MASS, si acceda al dataset forbes contenuto in tale libreria.\n\nSi acceda alla documentazione del dataset forbes e si descriva il contenuto del dataset: cosa rappresentano le variabili contenute in tale insieme di dati?\nSi ottengano le medie campionarie e le mediane per le variabili bp e pres. Si ottengano quindi il primo ed il terzo quartile. Sono presenti outlier nelle due distribuzioni?\nSi ottengano gli istogrammi di tali variabili, scegliendo opportunamente il numero di intervalli.\nSi ottenga un grafico che metta in relazione le variabili bp e pres.\nSi calcoli la correlazione tra le variabili bp e pres.\nIn un modello di regressione lineare semplice \\(y = \\alpha + \\beta x\\), dove bp rappresenta la variabile esplicativa (\\(x\\)) e pres rappresenta la variabile risposta (\\(y\\)), le stime ai minimi quadrati sono pari a \\[\n\\hat{\\alpha} = \\bar{y} - \\hat{\\beta}\\bar{x}, \\qquad \\hat{\\beta} = \\frac{\\text{cov}(x,y)}{\\text{var}(x)}.\n\\]\nSi rappresenti la retta di regressione ottenuta congiuntamenti ai dati. Il modello sembra adattarsi bene ai dati?"
  },
  {
    "objectID": "esami/esame_20_11_2020.html#problema-2",
    "href": "esami/esame_20_11_2020.html#problema-2",
    "title": "R per l’analisi statistica multivariata",
    "section": "Problema 2",
    "text": "Problema 2\nUna variabile aleatoria \\(X \\sim \\text{Burr}(\\alpha,\\beta)\\) segue una distribuzione di Burr di parametri \\(\\alpha, \\beta > 0\\). Si tratta di una variabile casuale assolutamente continua e a valori positivi avente la seguente densità:\n\\[\nf(x ; \\alpha, \\beta) = \\alpha \\beta \\frac{x^{\\alpha-1}}{(1 + x^\\alpha)^{\\beta+1}}, \\qquad x > 0.\n\\]\nÈ facile verificare che la funzione di ripartizione coincide con\n\\[\nF(x; \\alpha, \\beta) = 1 - \\frac{1}{(1 + x^\\alpha)^\\beta}, \\qquad x > 0.\n\\]\n\nSi ottenga analiticamente (ovvero utilizzando carta e penna) la funzione quantile \\(F^{-1}(p; \\alpha,\\beta)\\) della distribuzione di Burr, ovvero la funzione inversa di \\(F(x;\\alpha,\\beta) = p\\). Quindi, si scrivano in R le funzioni per il calcolo della densità, della funzione di ripartizione e la funzione quantile. Si chiamino queste funzioni dburr(x, alpha, beta), pburr(x, alpha, beta) e qburr(p, alpha, beta), rispettivamente.\nSi faccia un grafico della funzione di densità \\(f(x ; \\alpha, \\beta)\\) con \\(\\alpha = 2\\) e \\(\\beta = 1\\), in un intervallo opportuno.\nPer generare valori (pseudo) casuali dalla distribuzione di Burr è possibile utilizzare il metodo dell’inversione. Un singolo valore da una distribuzione di Burr si ottiene tramite il comando qburr(runif(1), alpha, beta). Si definisca quindi la funzione rburr(R, alpha, beta) che genera R valori pseudo casuali da una distribuzione di Burr.\nUtilizzando i numeri pseudo-casuali generati tramite la funzione rburr con \\(\\alpha = 2\\) e \\(\\beta = 1\\) si approssimino:\n\nIl valore atteso \\(E(X)\\).\nLa varianza \\(\\text{var}(X)\\).\nLa probabilità che \\(X\\) sia compresa tra \\(2\\) e \\(3\\).\n\nSi faccia un istogramma dei valori simulati al punto precedente e lo si confronti con la densità \\(f(x;\\alpha,\\beta)\\) per \\(\\alpha = 2\\) e \\(\\beta = 1\\).\nSi ottenga la funzione di ripartizione empirica dei valori simulati in precedenza e la si confronti con la funzione di ripartizione teorica \\(F(x;\\alpha,\\beta)\\) per \\(\\alpha = 2\\) e \\(\\beta = 1\\)."
  },
  {
    "objectID": "esami/esame_22_02_2022.html",
    "href": "esami/esame_22_02_2022.html",
    "title": "R per l’analisi statistica multivariata",
    "section": "",
    "text": "Si carichi in memoria il dataset swiss presente in R. Il dataset si riferisce a \\(n = 47\\) province della svizzera Francese.\n\n(1pt) Si aggiunga al dataset una nuova variabile, chiamata logEducation, la quale contiene il logaritmo della variabile Education.\n(1pt) Si produca un grafico opportuno che metta in relazione la variabile logEducation e Agriculture.\n(2pt) Si ottengano le matrici di covarianza e di correlazione relative alle variabili Fertility, Agriculture e logEducation.\n(2pt) Si calcolino degli opportuni indici di posizione e variabilità per la variabile Agriculture.\n(6pt) Si calcoli la correlazione parziale tra le variabili Agriculture e Fertility al netto della variabile logEducation, che si ottiene come segue. Si costruisca un modello di regressione lineare usando Agriculture come variabile risposta (\\(y\\)) e logEducation (\\(x\\)) come variabile esplicativa. Analogamente, si costruisca un modello di regressione usando Fertility come variabile risposta e logEducation come variabile esplicativa. Si ricordi che le stime ai minimi quadrati sono pari a \\[\n\\hat{\\alpha} = \\bar{y} - \\hat{\\beta}\\bar{x}, \\qquad \\hat{\\beta} = \\frac{\\text{cov}(x,y)}{\\text{var}(x)}.\n\\] Il coefficiente di correlazione parziale si ottiene quindi calcolando il coefficiente di correlazione tra i residui di entrambi i modelli."
  },
  {
    "objectID": "esami/esame_22_02_2022.html#problema-2",
    "href": "esami/esame_22_02_2022.html#problema-2",
    "title": "R per l’analisi statistica multivariata",
    "section": "Problema 2",
    "text": "Problema 2\nUna variabile aleatoria continua \\(X\\) segue una distribuzione di Kumaraswamy di parametri \\(\\alpha, \\beta\\) se la sua densità è pari a:\n\\[\nf(x) = \\alpha \\beta x^{\\alpha - 1}(1 - x^\\alpha)^{\\beta - 1}, \\qquad 0 < x < 1.\n\\]\nÈ inoltre possibile dimostrare che la funzione di ripartizione è pari a\n\\[\nF(x) = 1 - (1 - x^\\alpha)^\\beta, \\qquad 0 < x < 1.\n\\] Infine, la funzione quantile è pari a\n\\[\n\\mathcal{Q}(p) = (1 - (1 - p)^{1/\\beta})^{1/ \\alpha}, \\qquad 0 < p < 1.\n\\]\n\n(4pt) Si implementino le funzioni dkum(x, alpha, beta), pkum(x, alpha, beta) e qkum(x, alpha, beta) le quali fanno riferimento rispettivamente alla densità, alla funzione di ripartizione e alla funzione quantile.\n(2pt). Si faccia un grafico nell’intervallo \\((0, 1)\\) di tutte e tre le funzioni precedenti, per \\(\\alpha = \\beta = 2\\).\n(2pt) Si costruisca una funzione rkum(R, alpha, beta) che campiona R valori pseudo-casuali dalla variabile aleatoria di Kumaraswamy.\n(2pt) Si ottenga una stima Monte Carlo della densità di \\(X\\), quando \\(\\alpha = \\beta = 2\\) e la si confronti con la funzione di densità dkum ottenuta in precedenza.\n(2pt) Si ottenga un’approssimazione Monte Carlo della media \\(E(X)\\), quando \\(\\alpha = \\beta = 2\\). Si quantifichi opportunamente l’errore commesso."
  },
  {
    "objectID": "esami/esame_22_02_2022.html#problema-3",
    "href": "esami/esame_22_02_2022.html#problema-3",
    "title": "R per l’analisi statistica multivariata",
    "section": "Problema 3",
    "text": "Problema 3\nSiano \\(y = (y_1,\\dots,y_n)\\) delle realizzazioni iid di una variabile aleatoria discreta con legge Poisson di parametro \\(\\lambda\\). Si considerino i seguenti stimatori per la probabilità \\(\\psi = P(Y = 0)\\), dove \\(Y \\sim \\text{Pois}(\\lambda)\\)\n\\[\nT_1 = e^{-\\bar{y}}, \\qquad T_2 = \\frac{1}{n}\\sum_{i=1}^n I(y_i = 0),\n\\] in cui \\(\\bar{y}\\) e \\(I(\\cdot)\\) rappresentano la media aritmetica e la funzione indicatrice.\n\n(4pt) Supponendo \\(\\lambda = 2\\), si verifichi empiricamente se i due stimatori sono consistenti.\n(2pt) Supponendo \\(\\lambda = 2\\) e per \\(n = 20\\), si effettui uno studio di simulazione e si calcoli la distorsione degli stimatori \\(T_1\\) and \\(T_2\\).\n(2pt) Supponendo \\(\\lambda = 2\\) e per \\(n = 20\\), si stabilisca quale dei due stimatori è preferibile in termini di errore quadratico medio."
  },
  {
    "objectID": "esami/esame_24_02_2021.html",
    "href": "esami/esame_24_02_2021.html",
    "title": "R per l’analisi statistica multivariata",
    "section": "",
    "text": "I numeri di Stirling del secondo tipo \\(S(n,k)\\) rappresentano il numero di possibili partizioni di un insieme di \\(n\\) elementi formate da \\(k\\) termini. È possibile dimostrare che\n\\[\nS(n, k) = \\frac{1}{k!}\\sum_{j=0}^k(-1)^{k-j}\\binom{k}{j}j^n,\n\\] per qualsiasi valore di \\(k =1,\\dots,n\\). I numeri di Bell \\(B(n)\\) rappresentano invece il numero di possibili partizioni di un insieme di \\(n\\) elementi, independentemente dal numero di termini, ovvero\n\\[\nB(n) = \\sum_{k=1}^n S(n, k).\n\\]\n\n(6pt) Si scrivano in R le funzioni stirling2(n, k) e Bell(n) che calcolano, rispettivamente, i coefficienti \\(S(n,k)\\) e \\(B(n)\\).\n(1pt) Utilizzando le funzioni del punto precedente, si dica in quanti modi è possibile dividere un insieme di \\(10\\) elementi utilizzando \\(5\\) gruppi.\n(1pt) Utilizzando le funzioni dei punti precedenti, si dica in quanti modi è possibile partizionare un insieme di \\(10\\) elementi."
  },
  {
    "objectID": "esami/esame_24_02_2021.html#problema-2",
    "href": "esami/esame_24_02_2021.html#problema-2",
    "title": "R per l’analisi statistica multivariata",
    "section": "Problema 2",
    "text": "Problema 2\nIl numero armonico generalizzato è definito come\n\\[\nH(n,\\alpha) = 1 + \\frac{1}{2^\\alpha} + \\cdots + \\frac{1}{n^\\alpha} = \\sum_{k=1}^n\\frac{1}{k^\\alpha}, \\qquad \\alpha > 0.\n\\]\nInoltre, una variabile aleatoria discreta \\(X\\) con supporto \\(\\{1,\\dots, n\\}\\) segue una distribuzione di Zipf se\n\\[\nP(X = k) = \\frac{k^{-\\alpha}}{H(n, \\alpha)}, \\qquad k=1,\\dots,n,\n\\] ed è pari a \\(0\\) altrimenti.\n\n(2pt) Si scriva in R la funzione H(n, alpha) che calcola il numero armonico generalizzato. Quanto vale H(10, 1)?\n(2pt) Si scriva in R la funzione di probabilità dzipf(k, n, alpha) di una legge Zipf di parametri \\(n\\) ed \\(\\alpha\\) e la si calcoli nei valori dzipf(5, 10, 2).\n(2pt) Per \\(n = 50\\) e \\(\\alpha = 1\\), si rappresenti graficamente la legge di probabilità di una distribuzione Zipf tramite un diagramma a bastoncini.\n(2pt) Si supponga che \\(X\\) segua una Zipf di parametri \\(n = 100\\) e \\(\\alpha = 2\\). Si calcoli la probabilità \\(P(X \\ge 10)\\).\n(3pt) Si scriva in R la funzione rzipf(R, n, alpha) che simula R valori casuali da una distribuzione Zipf. Suggerimento: si faccia uso della funzione sample.\n(2pt) Sfruttando la funzione rzipf, si ottenga un’approssimazione del valore atteso \\(E(X)\\), quando \\(n = 50\\) e \\(\\alpha = 1\\)."
  },
  {
    "objectID": "esami/esame_24_02_2021.html#problema-3",
    "href": "esami/esame_24_02_2021.html#problema-3",
    "title": "R per l’analisi statistica multivariata",
    "section": "Problema 3",
    "text": "Problema 3\nSi consideri il dataset bacteria della libreria MASS e lo si carichi in memoria. La variabile y indica la presenza (y) o l’assenza (n) del batterio “H influenzae” in alcuni bambini. La variabile trt indica invece il trattamento ricevuto.\n\n(3pt) L’indice di eterogeneità di Gini è definito come \\(G = 1 - \\sum_{j=1}^kf_j^2\\), dove \\(f_1,\\dots,f_k\\) sono le frequenze relative di una variabile qualitativa con modalità \\(c_1,\\dots,c_k\\). Si costruisca in R la funzione Gini(x) che calcola l’indice di Gini di una variabile qualitativa x. Si ottenga quindi Gini(bacteria$trt).\n(1pt) Si costruisca dataset bacteria2 contenente le osservazioni relative alla sesta settimana di sorveglianza (week = 6). Da quante osservazioni è composto?\n(1pt) Utilizzando il dataset bacteria2, si costruisca una tabella di contingenza che mette in relazione le variabili y e trt.\n(2pt) Utilizzando il dataset bacteria2, si ottengano le distribuzioni di frequenza condizionate della variabile y, per ciascun valore della variabile trt. Ci sono delle differenze tra queste distribuzioni?\n(2pt) Utilizzando il dataset bacteria2, si ri-eseguano i due punti precedenti (ovvero 3. e 4.) dopo aver raggruppato i valori drug e drug+ della variabile trt in un unico valore, chiamato ad esempio drug_and_drug+. I risultati sono diversi da quelli ottenuti al punto precedente (4.)?"
  }
]